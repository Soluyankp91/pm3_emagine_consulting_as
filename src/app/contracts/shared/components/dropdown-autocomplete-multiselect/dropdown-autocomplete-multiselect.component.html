<button mat-icon-button [matMenuTriggerFor]="menu" (onMenuOpen)="openPanel()" (onMenuClose)="menuClosed()">{{ label }}</button>
<mat-menu #menu="matMenu" >
	<mat-form-field (click)="$event.stopPropagation()">
		<mat-label>{{ label }}</mat-label>
		<input type="text" matInput [matAutocomplete]="autoName" [formControl]="inputControl" #trigger="matAutocompleteTrigger" />
		<mat-autocomplete #autoName="matAutocomplete">
			<mat-option>
				<mat-checkbox (click)="$event.stopPropagation()" (change)="toggleSelectAll()" [checked]="selectedAll">
					{{ selectedAll ? 'unselect' : 'selectAll' }}
				</mat-checkbox>
			</mat-option>
            <div>
			<ng-container *ngFor="let selectedOption of selectedOptions; trackBy: trackById.bind(this)">
				<mat-option>
					<mat-checkbox
						*ngIf="selectedOption"
						[checked]="true"
						(click)="$event.stopPropagation()"
						(change)="unSelectCheckBox(selectedOption)">
						{{ selectedOption.name }}
					</mat-checkbox>
				</mat-option>
			</ng-container>
        </div>
			<mat-divider></mat-divider>
			<ng-container *ngIf="!isSearchNull; else notFound">
				<ng-container *ngFor="let option of availableOptions; trackBy: trackById.bind(this)">
					<mat-option>
						<mat-checkbox (click)="$event.stopPropagation()" (change)="selectCheckBox(option)">
							{{ option.name }}
						</mat-checkbox>
					</mat-option>
				</ng-container>
			</ng-container>
			<ng-template #notFound>
				<mat-option>Not Found</mat-option>
			</ng-template>
		</mat-autocomplete>
	</mat-form-field>
</mat-menu>
