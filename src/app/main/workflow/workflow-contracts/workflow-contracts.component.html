<div class="workflow-contracts">
    <ng-container [ngSwitch]="true">
        <ng-container *ngSwitchCase="activeSideSection === workflowSideSections.TerminateWorkflow || activeSideSection === workflowSideSections.TerminateConsultant">
            <div class="workflow--termination">
                <h2 class="workflow-section--header">Finish contract in PM</h2>

                <button class="button-accept u-mb--10" mat-flat-button>
                    Sync to legacy system
                </button>

                <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--10">
                    <span class="icon-cancel u-mr--5">
                        x
                    </span>
                    <span class="sync-hint-text">
                        Sync not possible
                    </span>
                </div>

                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                    <mat-checkbox color="accent" name="contractLinesDoneManuallyInOldPM" [formControl]="contractLinesDoneManuallyInOldPMControl" class="black-checkbox u-mt--10">
                        Contract lines done manually in old PM
                    </mat-checkbox>
                </div>

                <mat-divider class="u-w--100"></mat-divider>
                <form fxLayout="column" fxLayoutAlign="start start" [formGroup]="contractsTerminationConsultantForm" class="workflow-form u-w--100" id="consultantData">
                    <ng-container formArrayName="consultantTerminationContractData">
                        <div *ngFor="let consultant of contractsTerminationConsultantForm.consultantTerminationContractData.controls; index as i; last as last" [formGroupName]="i" class="workflow-contracts--block-consultants u-mt--20" [ngClass]="{'last-block': last}">
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20">
                                <img class="workflow-contracts--consultant-img u-mr--16" src="https://placekitten.com/50/50">
                                <p class="workflow-contracts--consultant-name">
                                    {{contractsTerminationConsultantForm.consultantTerminationContractData.at(i).get('consultantData')?.value?.name}}
                                </p>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-checkbox color="accent" name="removedConsultantFromAnyManualChecklists" formControlName="removedConsultantFromAnyManualChecklists" class="black-checkbox u-mr--10">
                                    Removed Consultant from any manual checklists
                                </mat-checkbox>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--20">
                                <mat-checkbox color="accent" name="deletedAnySensitiveDocumentsForGDPR" formControlName="deletedAnySensitiveDocumentsForGDPR" class="black-checkbox u-mr--10">
                                    Deleted any sensitive documents (GDPR)
                                </mat-checkbox>
                            </div>
                        </div>
                    </ng-container>
                </form>
            </div>
        </ng-container>
        <ng-container *ngSwitchDefault>
            <form [formGroup]="contractsMainForm" id="mainData" class="workflow-form workflow-form--main u-w--100">
                <div fxLayout="column" fxLayoutAlign="start start" class="workflow-contracts--process-data u-w--100">
                    <h1 class="workflow-readonly--header-main">
                        <span class="process-name" *ngIf="readOnlyMode">Contracts.</span>
                        <span class="anchor-name">Main data</span>
                    </h1>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20 u-mt--20">
                        <!-- <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-gray--header">Sales Type</h3>
                            <span class="workflow-darkblue--text">{{contractsMainForm?.salesType?.value?.name}}</span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-gray--header">Delivery Type</h3>
                            <span class="workflow-darkblue--text">{{contractsMainForm?.deliveryType?.value?.name}}</span>
                        </div> -->
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-readonly--gray-header">Project Type (Legacy)</h3>
                            <span class="workflow-readonly--blue-text-bold">
                                {{contractsMainForm?.projectType?.value?.name ? contractsMainForm?.projectType?.value?.name : '-' }}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-readonly--gray-header">Sales Type</h3>
                            <span class="workflow-readonly--blue-text-bold">
                                {{contractsMainForm?.salesType?.value?.name ? contractsMainForm?.salesType?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-readonly--gray-header">Delivery Type</h3>
                            <span class="workflow-readonly--blue-text-bold">
                                {{contractsMainForm?.deliveryType?.value?.name ? contractsMainForm?.deliveryType?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-readonly--gray-header">Margin</h3>
                            <span class="workflow-readonly--blue-text-bold">
                                {{contractsMainForm?.margin?.value?.name ? contractsMainForm?.margin?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>
                    <h3 class="workflow-gray--header">Project Description</h3>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <ng-container *ngIf="readOnlyMode; else projectDescriptionInput">
                            <span class="workflow-readonly--blue-text">
                                {{contractsMainForm?.projectDescription?.value ? contractsMainForm?.projectDescription?.value : '-'}}
                            </span>
                        </ng-container>
                        <ng-template #projectDescriptionInput>
                            <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                <mat-label>Project Description</mat-label>
                                <textarea matInput autocomplete="new-password" name="projectDescription" formControlName="projectDescription">
                                </textarea>
                            </mat-form-field>
                        </ng-template>
                    </div>
                    <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <h3 class="workflow-gray--header">Discounts</h3>
                        <span class="workflow-darkblue--text">{{contractsMainForm?.discounts?.value?.name ? contractsMainForm?.discounts?.value?.name : '-'}}</span>
                        <!-- <span class="workflow-darkblue--text">SKI 02.17</span> -->
                    </div>
                    <h3 class="workflow-gray--header">Remarks</h3>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                        <ng-container *ngIf="readOnlyMode; else remarksInput">
                            <span class="workflow-readonly--blue-text" *ngIf="contractsMainForm?.noRemarks?.value">
                                No remarks
                            </span>
                            <span class="workflow-readonly--blue-text" *ngIf="contractsMainForm?.remarks?.value">
                                {{contractsMainForm?.remarks?.value ? contractsMainForm?.remarks?.value : '-'}}
                            </span>
                        </ng-container>
                        <ng-template #remarksInput>
                            <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                <mat-label>Remarks</mat-label>
                                <textarea matInput autocomplete="new-password" name="remarks" formControlName="remarks">
                                </textarea>
                            </mat-form-field>
                        </ng-template>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100" *ngIf="!readOnlyMode">
                        <mat-checkbox color="accent" formControlName="noRemarks" name="noRemarks" class="black-checkbox" (change)="disableOrEnableInput(contractsMainForm?.noRemarks?.value, contractsMainForm?.remarks)">
                            None
                        </mat-checkbox>
                    </div>
                </div>
            </form>

            <!-- hidden on AddConsultant, ChangeConsultant, Extend Consultant -->
            <ng-container *ngIf="activeSideSection === workflowSideSections.StartClientPeriod || activeSideSection === workflowSideSections.ExtendClientPeriod || activeSideSection === workflowSideSections.ChangeClientPeriod">
                <form fxLayout="column" fxLayoutAlign="start start" id="clientData" [formGroup]="contractClientForm" class="workflow-form workflow-form--sales u-w--100">
                    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-contracts--process-data u-w--100">
                        <h1 class="workflow-readonly--header-main">
                            <span class="process-name" *ngIf="readOnlyMode">Contracts.</span>
                            <span class="anchor-name">Client data</span>
                        </h1>
                        <div fxLayout="column" class="u-mb--20 u-mt--20">
                            <h3 class="workflow-gray--header">Shared Cap on Hour Reporting</h3>
                            <span class="workflow-darkblue--text">{{contractClientForm?.capOnTimeReporting?.value?.name ? contractClientForm?.capOnTimeReporting?.value?.name : '-'}}</span>
                            <!-- <span class="workflow-darkblue--text">Cap on units</span> -->
                        </div>

                        <h3 class="workflow-gray--header">Special Contract Terms</h3>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                            <ng-container *ngIf="readOnlyMode; else specialContractTermsInput">
                                <span class="workflow-readonly--blue-text">
                                    {{contractClientForm?.specialContractTerms?.value}}
                                </span>
                                <span class="workflow-readonly--blue-text" *ngIf="contractClientForm?.noSpecialContractTerms?.value">
                                    No special contract terms
                                </span>
                                <span class="workflow-readonly--blue-text" *ngIf="contractClientForm?.specialContractTerms?.value">
                                    {{contractClientForm?.specialContractTerms?.value ? contractClientForm?.specialContractTerms?.value : '-'}}
                                </span>
                            </ng-container>
                            <ng-template #specialContractTermsInput>
                                <mat-form-field appearance="outline" class="u-w--100  textarea-input" fxFlex="0 0 calc(66% + 16px)">
                                    <mat-label>Special Contract Terms</mat-label>
                                    <textarea matInput autocomplete="new-password" name="specialContractTerms" formControlName="specialContractTerms">
                                    </textarea>
                                </mat-form-field>
                            </ng-template>
                        </div>

                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20" *ngIf="!readOnlyMode">
                            <mat-checkbox color="accent" formControlName="noSpecialContractTerms" name="noSpecialContractTerms" class="black-checkbox u-mt--10" (change)="disableOrEnableInput(contractClientForm?.noSpecialContractTerms?.value, contractClientForm?.specialContractTerms)">
                                None
                            </mat-checkbox>
                        </div>

                        <h2 class="workflow-section--header u-mt--20">Client Special Rates</h2>
                        <div class="inline-edit-form u-w--100">
                            <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="contractClientForm.clientRates?.controls?.length">
                                <span fxFlex="25%" class="workflow-contracts--list-header u-w--100">
                                    Rate name
                                </span>
                                <span fxFlex="25%" class="workflow-contracts--list-header u-w--100">
                                    Rate direction
                                </span>
                                <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                    Reporting unit
                                </span>
                                <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                    Client rate
                                </span>
                                <span fxFlex="10%" class="workflow-contracts--list-header u-w--100">

                                </span>
                            </div>
                            <ng-container formArrayName="clientRates" class="u-w--100">
                                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                    *ngFor="let rate of contractClientForm.clientRates.controls; index as i"
                                    [formArrayName]="i">
                                    <ng-container *ngIf="rate.value.editable">
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="25%">
                                            <input matInput type="text" formControlName="rateName" placeholder="Rate name" />
                                        </mat-form-field>
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="25%">
                                            <mat-select formControlName="rateDirection" placeholder="Rate direction" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of clientSpecialRateOrFeeDirections" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                            <mat-select formControlName="reportingUnit" placeholder="Reporting Unit" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of clientSpecialRateReportUnits" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <div fxFlex="20%" fxLayout="row" fxLayoutAlign="start start">
                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                <input matInput type="text" placeholder="Rate" formControlName="clientRateValue">
                                            </mat-form-field>
                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                <mat-select formControlName="clientRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                    <mat-option *ngFor="let item of currencies" [value]="item">
                                                        {{ item.name }}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                            <button mat-flat-button (click)="editOrSaveSpecialRate(contractClientForm?.clientRates?.at(i)?.get('editable')?.value, i)" class="inline-edit-form--btn__save">
                                                Save
                                            </button>
                                            <button mat-icon-button (click)="removeClientRate(i)">
                                                <mat-icon>clear</mat-icon>
                                            </button>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="!rate.value.editable">
                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientRates.at(i).get('rateName')?.value">
                                            {{rate.value.rateName}}
                                        </span>
                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientRates.at(i).get('rateDirection')?.value?.name">
                                            {{rate.value.rateDirection?.name}}
                                        </span>
                                        <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientRates.at(i).get('reportingUnit')?.value?.name">
                                            {{rate.value.reportingUnit?.name}}
                                        </span>
                                        <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientRates.at(i).get('clientRateValue')?.value + ' ' + contractClientForm.clientRates.at(i).get('clientRateCurrency')?.value?.name">
                                            {{rate.value.clientRateValue || rate.value.clientRateCurrency?.name ? rate.value.clientRateValue + ' ' + rate.value.clientRateCurrency?.name : '-'}}
                                        </span>
                                        <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100">
                                            <button mat-icon-button (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientRateMenu" class="three-dots-actions-btn">
                                                <mat-icon>more_horiz</mat-icon>
                                            </button>
                                            <mat-menu #clientRateMenu>
                                                <button
                                                    class="menu-item menu-item--edit"
                                                    mat-menu-item
                                                    [disabled]="false"
                                                    (click)="editOrSaveSpecialRate(rate.value.editable, i)">
                                                    <mat-icon>create</mat-icon>
                                                    Edit
                                                </button>
                                                <button
                                                    class="menu-item menu-item--cancel"
                                                    mat-menu-item
                                                    (click)="removeClientRate(i)">
                                                    <mat-icon>clear</mat-icon>
                                                    Delete
                                                </button>
                                            </mat-menu>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                            <button [ngClass]="contractClientForm!.clientRates!.controls!.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button (click)="addSpecialRate()">
                                <mat-icon *ngIf="contractClientForm.clientRates?.controls?.length">add</mat-icon>
                                Add special rates
                            </button>
                        </div>

                        <h2 class="workflow-section--header">Client Fees</h2>
                        <div class="inline-edit-form u-w--100">
                            <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="contractClientForm.clientFees?.controls?.length">
                                <span fxFlex="25%" class="workflow-contracts--list-header u-w--100">
                                    Fee name
                                </span>
                                <span fxFlex="25%" class="workflow-contracts--list-header u-w--100">
                                    Fee direction
                                </span>
                                <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                    Frequency
                                </span>
                                <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                    Client fee
                                </span>
                                <span fxFlex="10%" class="workflow-contracts--list-header u-w--100">

                                </span>
                            </div>
                            <ng-container formArrayName="clientFees" class="u-w--100">
                                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                    *ngFor="let fee of contractClientForm.clientFees.controls; index as i"
                                    [formArrayName]="i">
                                    <ng-container *ngIf="fee.value.editable">
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="25%">
                                            <input matInput type="text" formControlName="feeName" placeholder="Fee name" />
                                        </mat-form-field>
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="25%">
                                            <mat-select formControlName="feeDirection" placeholder="Fee direction" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of clientSpecialRateOrFeeDirections" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                            <mat-select formControlName="feeFrequency" placeholder="Frequency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of clientSpecialFeeFrequencies" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <div fxFlex="20%" fxLayout="row" fxLayoutAlign="start start">
                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                <input matInput type="text" placeholder="Rate" formControlName="clientRateValue">
                                            </mat-form-field>
                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                <mat-select formControlName="clientRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                    <mat-option *ngFor="let item of currencies" [value]="item">
                                                        {{ item.name }}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                            <button mat-flat-button (click)="editOrSaveClientFee(contractClientForm.clientFees.at(i).get('editable')?.value, i)" class="inline-edit-form--btn__save">
                                                Save
                                            </button>
                                            <button mat-icon-button (click)="removeClientFee(i)">
                                                <mat-icon>clear</mat-icon>
                                            </button>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="!fee.value.editable">
                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientFees.at(i).get('feeName')?.value ?? '-'">
                                            {{fee.value.feeName ?? '-'}}
                                        </span>
                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientFees.at(i).get('feeDirection')?.value?.name ?? '-'">
                                            {{fee.value.feeDirection?.name ?? '-'}}
                                        </span>
                                        <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientFees.at(i).get('feeFrequency')?.value?.name ?? '-'">
                                            {{fee.value.feeFrequency?.name ?? '-'}}
                                        </span>
                                        <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="contractClientForm.clientFees.at(i).get('clientRateValue')?.value + ' ' + contractClientForm.clientFees.at(i).get('clientRateCurrency')?.value?.name">
                                            {{fee.value.clientRateValue || fee.value.clientRateCurrency?.name ? fee.value.clientRateValue + ' ' + fee.value.clientRateCurrency?.name : '-'}}
                                        </span>
                                        <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100">
                                            <button *ngIf="fee.value.editable"
                                                    mat-icon-button
                                                    [disabled]="false"
                                                    (click)="editOrSaveClientFee(fee.value.editable, i)">
                                                    <mat-icon>save</mat-icon>
                                            </button>
                                            <button mat-icon-button (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientFeeMenu" class="three-dots-actions-btn">
                                                <mat-icon>more_horiz</mat-icon>
                                            </button>
                                            <mat-menu #clientFeeMenu>
                                                <button
                                                    class="menu-item menu-item--edit"
                                                    *ngIf="!fee.value.editable"
                                                    mat-menu-item
                                                    [disabled]="false"
                                                    (click)="editOrSaveClientFee(fee.value.editable, i)">
                                                    <mat-icon>create</mat-icon>
                                                    Edit
                                                </button>
                                                <button
                                                    class="menu-item menu-item--cancel"
                                                    mat-menu-item
                                                    (click)="removeClientFee(i)">
                                                    <mat-icon>clear</mat-icon>
                                                    Remove
                                                </button>
                                            </mat-menu>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                            <button [ngClass]="contractClientForm!.clientFees!.controls!.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button (click)="addClientFee()">
                                <mat-icon *ngIf="contractClientForm.clientFees?.controls?.length">add</mat-icon>
                                Add special fee
                            </button>
                        </div>
                    </div>
                </form>
            </ng-container>

            <form [formGroup]="contractsConsultantsDataForm" class="u-w--100" id="consultantData">
                <ng-container formArrayName="consultants">
                    <div *ngFor="let consultant of contractsConsultantsDataForm.consultants.controls; let consultantIndex = index" [formGroupName]="consultantIndex" class="workflow-form--consultants u-w--100">
                        <div fxLayout="column" fxLayoutAlign="start start" class="workflow-contracts--process-data u-w--100">
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--20">
                                <h1 class="workflow-readonly--header-main" fxFlex="{{readOnlyMode ? '25%' : '15%'}}">
                                    <span class="process-name" *ngIf="readOnlyMode">Contracts.</span>
                                    <span class="anchor-name">Consultant data</span>
                                </h1>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                                    <span fxFlex="50%" fxLayout="row" fxLayoutAlign="start center">
                                        <img class="border-rounded-50 u-ml--16 u-mr--16" src="https://picsum.photos/35/35" />
                                        <span class="workflow-form--consultants__name u-mr--16">
                                            {{ consultant.value?.nameOnly}}
                                        </span>
                                    </span>
                                    <div fxFlex="50%" fxLayoutAlign="end center" *ngIf="!readOnlyMode">
                                        <!-- <span class="workflow-form--consultants__period u-mr--8">
                                            {{consultant.value.startDate | momentFormat: 'DD.MM.YYYY'}}
                                            -
                                            {{consultant.value.endDate | momentFormat: 'DD.MM.YYYY'}}
                                        </span> -->
                                        <button mat-icon-button [matMenuTriggerFor]="consultantMenu" type="button" (click)="$event.stopPropagation();" class="workflow-icon--actions u-mr--16"><mat-icon>more_horiz</mat-icon></button>
                                        <mat-menu #consultantMenu>
                                            <button
                                                class="menu-item menu-item--edit"
                                                mat-menu-item
                                                [disabled]="false"
                                                (click)="changeConsultantData(consultantIndex)">
                                                <mat-icon>create</mat-icon>
                                                Change consultant data
                                            </button>
                                            <button
                                                class="menu-item menu-item--edit"
                                                mat-menu-item
                                                [disabled]="false"
                                                (click)="extendConsultant(consultantIndex)">
                                                <mat-icon>add</mat-icon>
                                                Extend consultant
                                            </button>
                                            <button
                                                class="menu-item menu-item--cancel"
                                                mat-menu-item
                                                (click)="terminateConsultant(consultantIndex)">
                                                <mat-icon>clear</mat-icon>
                                                Terminate consultant
                                            </button>
                                        </mat-menu>
                                    </div>
                                </div>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                                <div fxLayout="column" class="u-mb--20" fxFlex="25%">
                                    <h3 class="workflow-gray--header">Consultant type</h3>
                                    <span class="workflow-darkblue--text">{{consultant.value.consultantType?.name ? consultant.value.consultantType?.name : '-'}}</span>
                                </div>
                                <div fxLayout="column" class="u-mb--20" fxFlex="25%">
                                    <h3 class="workflow-gray--header">Cap on Time Reporting</h3>
                                    <span class="workflow-darkblue--text" *ngIf="!consultant.value.consultantCapOnTimeReportingValue && !consultant.value.consultantCapOnTimeReportingCurrency?.name; else consultantCapOnTimeTemplate">
                                        -
                                    </span>
                                    <ng-template #consultantCapOnTimeTemplate>
                                        <span class="workflow-darkblue--text">
                                            {{consultant.value.consultantCapOnTimeReportingValue}} {{consultant.value.consultantCapOnTimeReportingCurrency?.name}}
                                        </span>
                                    </ng-template>
                                </div>
                            </div>

                            <h3 class="workflow-gray--header">Special Contract Terms</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                                <ng-container *ngIf="readOnlyMode; else consultantsSpecialContractTermsInput">
                                    <span class="workflow-readonly--blue-text" *ngIf="consultant.value.specialContractTerms">
                                        {{consultant.value.specialContractTerms ? consultant.value.specialContractTerms : '-'}}
                                    </span>
                                    <span class="workflow-readonly--blue-text" *ngIf="consultant.value.noSpecialContractTerms">
                                        No contract special terms
                                    </span>
                                </ng-container>
                                <ng-template #consultantsSpecialContractTermsInput>
                                    <mat-form-field appearance="outline" class="u-w--100  textarea-input" fxFlex="0 0 calc(66% + 16px)">
                                        <mat-label>Special Contract Terms</mat-label>
                                        <textarea matInput autocomplete="new-password" name="specialContractTerms" formControlName="specialContractTerms">
                                        </textarea>
                                    </mat-form-field>
                                </ng-template>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20" *ngIf="!readOnlyMode">
                                <mat-checkbox
                                    color="accent"
                                    formControlName="noSpecialContractTerms"
                                    name="noSpecialContractTerms"
                                    class="black-checkbox u-mt--10"
                                    (change)="disableOrEnableInput(contractsConsultantsDataForm?.consultants?.at(consultantIndex)?.get('noSpecialContractTerms')?.value, contractsConsultantsDataForm?.consultants?.at(consultantIndex)?.get('specialContractTerms'))">
                                    None
                                </mat-checkbox>
                            </div>

                            <h2 class="workflow-section--header u-mt--20">Special Rates</h2>

                            <ng-container *ngIf="readOnlyMode; else specialRatesInput">
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.specialRates?.length">
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Rate name
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Rate direction
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Reporting unit
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            ProData rate
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            Consultant rate
                                        </span>
                                    </div>
                                    <ng-container class="u-w--100 u-pl--16 u-pr--16">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                            *ngFor="let rate of getConsultantSpecialRateControls(consultantIndex); let specialRateIndex = index">
                                            <ng-container *ngIf="!rate.value.editable">
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.rateName">
                                                    {{rate.value.rateName}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.rateDirection?.name">
                                                    {{rate.value.rateDirection?.name}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.reportingUnit?.name">
                                                    {{rate.value.reportingUnit?.name}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.proDataRateValue + ' ' + rate.value.proDataRateCurrency?.name">
                                                    {{rate.value.proDataRateValue || rate.value.proDataRateCurrency?.name ? rate.value.proDataRateValue + ' ' + rate.value.proDataRateCurrency?.name : '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.consultantRateValue + ' ' + rate.value.consultantRateCurrency?.name">
                                                    {{rate.value.consultantRateValue || rate.value.consultantRateCurrency?.name ? rate.value.consultantRateValue + ' ' + rate.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <ng-template #specialRatesInput>
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.specialRates?.length">
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Rate name
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Rate direction
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Reporting unit
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            ProData rate
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            Consultant rate
                                        </span>
                                        <span fxFlex="10%" class="workflow-contracts--list-header u-w--100">

                                        </span>
                                    </div>
                                    <ng-container formArrayName="specialRates" class="u-w--100 u-pl--16 u-pr--16">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                            *ngFor="let rate of getConsultantSpecialRateControls(consultantIndex); let specialRateIndex = index" [formGroupName]="specialRateIndex">
                                            <ng-container *ngIf="rate.value.editable">
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <input matInput type="text" formControlName="rateName" placeholder="Rate name" />
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <mat-select formControlName="rateDirection" placeholder="Rate direction" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of clientSpecialRateOrFeeDirections" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <mat-select formControlName="reportingUnit" placeholder="Reporting Unit" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of clientSpecialRateReportUnits" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxFlex="15%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="text" placeholder="Rate" formControlName="proDataRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="proDataRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="15%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="text" placeholder="Rate" formControlName="consultantRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="consultantRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                                    <button mat-flat-button (click)="editOrSaveConsultantSpecialRate(rate?.value.editable, consultantIndex, specialRateIndex)" class="inline-edit-form--btn__save">
                                                        Save
                                                    </button>
                                                    <button mat-icon-button (click)="removeConsultantDataSpecialRate(consultantIndex, specialRateIndex)">
                                                        <mat-icon>clear</mat-icon>
                                                    </button>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="!rate.value.editable">
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.rateName">
                                                    {{rate.value.rateName}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.rateDirection?.name">
                                                    {{rate.value.rateDirection?.name}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.reportingUnit?.name">
                                                    {{rate.value.reportingUnit?.name}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.proDataRateValue + ' ' + rate.value.proDataRateCurrency?.name">
                                                    {{rate.value.proDataRateValue || rate.value.proDataRateCurrency?.name ? rate.value.proDataRateValue + ' ' + rate.value.proDataRateCurrency?.name : '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="rate.value.consultantRateValue + ' ' + rate.value.consultantRateCurrency?.name">
                                                    {{rate.value.consultantRateValue || rate.value.consultantRateCurrency?.name ? rate.value.consultantRateValue + ' ' + rate.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                                <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100 workflow-contracts--list-item">
                                                    <button mat-icon-button (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientRateMenu" class="three-dots-actions-btn">
                                                        <mat-icon>more_horiz</mat-icon>
                                                    </button>
                                                    <mat-menu #clientRateMenu>
                                                        <button
                                                            class="menu-item menu-item--edit"
                                                            mat-menu-item
                                                            [disabled]="false"
                                                            (click)="editOrSaveConsultantSpecialRate(rate.value.editable, consultantIndex, specialRateIndex)">
                                                            <mat-icon>create</mat-icon>
                                                            Edit
                                                        </button>
                                                        <button
                                                            class="menu-item menu-item--cancel"
                                                            mat-menu-item
                                                            (click)="removeConsultantDataSpecialRate(consultantIndex, specialRateIndex)">
                                                            <mat-icon>clear</mat-icon>
                                                            Delete
                                                        </button>
                                                    </mat-menu>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                                    <button [ngClass]="consultant.value.specialRates?.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button (click)="addSpecialRateToConsultantData(consultantIndex)" *ngIf="!readOnlyMode">
                                        <mat-icon *ngIf="consultant.value.specialRates?.length">add</mat-icon>
                                        Add special rates
                                    </button>
                                </div>
                            </ng-template>


                            <h2 class="workflow-section--header">Client Fees</h2>
                            <ng-container *ngIf="readOnlyMode; else clientFeesInput">
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.clientFees?.length">
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Fee name
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Fee direction
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Frequency
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            ProData fee
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            Consultant fee
                                        </span>
                                    </div>
                                    <ng-container class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                            *ngFor="let fee of getConsultantClientFeesControls(consultantIndex); let clientFeeIndex = index">
                                            <ng-container *ngIf="!fee.value.editable">
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeName ?? '-'">
                                                    {{fee.value.feeName ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeDirection?.name ?? '-'">
                                                    {{fee.value.feeDirection?.name ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeFrequency?.name ?? '-'">
                                                    {{fee.value.feeFrequency?.name ?? '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.proDataRateValue + ' ' + fee.value.proDataRateCurrency?.name">
                                                    {{fee.value.proDataRateValue || fee.value.proDataRateCurrency?.name ? fee.value.proDataRateValue + ' ' + fee.value.proDataRateCurrency?.name : '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.consultantRateValue + ' ' + fee.value.consultantRateCurrency?.name">
                                                    {{fee.value.consultantRateValue || fee.value.consultantRateCurrency?.name ? fee.value.consultantRateValue + ' ' + fee.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <ng-template #clientFeesInput>
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.clientFees?.length">
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Fee name
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Fee direction
                                        </span>
                                        <span fxFlex="20%" class="workflow-contracts--list-header u-w--100">
                                            Frequency
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            ProData fee
                                        </span>
                                        <span fxFlex="15%" class="workflow-contracts--list-header u-w--100">
                                            Consultant fee
                                        </span>
                                        <span fxFlex="10%" class="workflow-contracts--list-header u-w--100">

                                        </span>
                                    </div>
                                    <ng-container formArrayName="clientFees" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16"
                                            *ngFor="let fee of getConsultantClientFeesControls(consultantIndex); let clientFeeIndex = index" [formGroupName]="clientFeeIndex">
                                            <ng-container *ngIf="fee.value.editable">
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <input matInput type="text" formControlName="feeName" placeholder="Fee name" />
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <mat-select formControlName="feeDirection" placeholder="Fee direction" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of clientSpecialRateOrFeeDirections" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="20%">
                                                    <mat-select formControlName="feeFrequency" placeholder="Frequency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of clientSpecialFeeFrequencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxFlex="15%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="text" placeholder="Rate" formControlName="proDataRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="proDataRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="15%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="text" placeholder="Rate" formControlName="consultantRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="consultantRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                                    <button mat-flat-button (click)="editOrSaveConsultantSpecialFee(fee.value.editable, consultantIndex, clientFeeIndex)" class="inline-edit-form--btn__save">
                                                        Save
                                                    </button>
                                                    <button mat-icon-button (click)="removeConsultantDataClientFees(consultantIndex, clientFeeIndex)">
                                                        <mat-icon>clear</mat-icon>
                                                    </button>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="!fee.value.editable">
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeName ?? '-'">
                                                    {{fee.value.feeName ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeDirection?.name ?? '-'">
                                                    {{fee.value.feeDirection?.name ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.feeFrequency?.name ?? '-'">
                                                    {{fee.value.feeFrequency?.name ?? '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.proDataRateValue + ' ' + fee.value.proDataRateCurrency?.name">
                                                    {{fee.value.proDataRateValue || fee.value.proDataRateCurrency?.name ? fee.value.proDataRateValue + ' ' + fee.value.proDataRateCurrency?.name : '-'}}
                                                </span>
                                                <span fxFlex="15%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="fee.value.consultantRateValue + ' ' + fee.value.consultantRateCurrency?.name">
                                                    {{fee.value.consultantRateValue || fee.value.consultantRateCurrency?.name ? fee.value.consultantRateValue + ' ' + fee.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                                <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100 workflow-contracts--list-item">
                                                    <button mat-icon-button (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientFeeMenu" class="three-dots-actions-btn">
                                                        <mat-icon>more_horiz</mat-icon>
                                                    </button>
                                                    <mat-menu #clientFeeMenu>
                                                        <button
                                                            class="menu-item menu-item--cancel"
                                                            mat-menu-item
                                                            (click)="removeConsultantDataClientFees(consultantIndex, clientFeeIndex)">
                                                            <mat-icon>clear</mat-icon>
                                                            Remove
                                                        </button>
                                                    </mat-menu>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                                    <button [ngClass]="consultant.value.clientFees?.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button (click)="addClientFeesToConsultantData(consultantIndex)" *ngIf="!readOnlyMode">
                                        <mat-icon *ngIf="consultant.value.clientFees?.length">add</mat-icon>
                                        Add special fees
                                    </button>
                                </div>
                            </ng-template>

                            <h2 class="workflow-section--header">Project Lines</h2>
                            <ng-container *ngIf="readOnlyMode; else projectLinesInput">
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.projectLines?.length">
                                        <div fxFlex="5%">
                                            <span class="workflow-contracts--list-header">Unique id</span>
                                        </div>
                                        <div fxFlex="17%">
                                            <span class="workflow-contracts--list-header">Project name</span>
                                        </div>
                                        <div fxFlex="17%">
                                            <span class="workflow-contracts--list-header">Assignment ID/PO No</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">Start date</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">End date</span>
                                        </div>
                                        <div fxFlex="10%">
                                            <span class="workflow-contracts--list-header">Invoice ref</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">Last changed</span>
                                        </div>
                                        <div fxFlex="20%">
                                            <span class="workflow-contracts--list-header">Optional Invoicing Info</span>
                                        </div>
                                    </div>
                                    <ng-container class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px"
                                            class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16" *ngFor="let projectLine of getConsultantProjectLinesControls(consultantIndex); let projectLinesIndex = index">
                                            <span fxFlex="5%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.id ?? '-'">
                                                {{projectLine.value.id ?? '-'}}
                                            </span>
                                            <span fxFlex="17%" class="u-w--100 text-truncate-ellipsis__multilne workflow-contracts--list-item" [matTooltip]="projectLine.value.projectName ?? '-'">
                                                {{projectLine.value.projectName ?? '-'}}
                                            </span>
                                            <span fxFlex="17%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.invoiceRecipientId?.name ?? '-'">
                                                {{projectLine.value.invoiceRecipientId?.name ?? '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.startDate ? (projectLine.value.startDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.startDate ? (projectLine.value.startDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.endDate ? (projectLine.value.endDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.endDate ? (projectLine.value.endDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.invoicingReferenceNumber ?? '-'">
                                                {{projectLine.value.invoicingReferenceNumber ?? '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.modificationDate ? (projectLine.value.modificationDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.modificationDate ? (projectLine.value.modificationDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis__multilne workflow-contracts--list-item" [matTooltip]="projectLine.value.optionalInvoicingInfo ?? '-'">
                                                {{projectLine.value.optionalInvoicingInfo ?? '-'}}
                                            </span>
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <ng-template #projectLinesInput>
                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="u-w--100 u-pl--16 u-pr--16" *ngIf="consultant.value.projectLines?.length">
                                        <div fxFlex="5%">
                                            <span class="workflow-contracts--list-header">Unique id</span>
                                        </div>
                                        <div fxFlex="17%">
                                            <span class="workflow-contracts--list-header">Project name</span>
                                        </div>
                                        <div fxFlex="17%">
                                            <span class="workflow-contracts--list-header">Assignment ID/PO No</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">Start date</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">End date</span>
                                        </div>
                                        <div fxFlex="10%">
                                            <span class="workflow-contracts--list-header">Invoice ref</span>
                                        </div>
                                        <div fxFlex="7%">
                                            <span class="workflow-contracts--list-header">Last changed</span>
                                        </div>
                                        <div fxFlex="20%">
                                            <span class="workflow-contracts--list-header">Optional Invoicing Info</span>
                                        </div>
                                        <div fxFlex="10%">
                                        </div>
                                    </div>
                                    <ng-container formArrayName="projectLines" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px"
                                            class="workflow-contracts--list u-w--100 u-pl--16 u-pr--16" *ngFor="let projectLine of getConsultantProjectLinesControls(consultantIndex); let projectLinesIndex = index" [formGroupName]="projectLinesIndex">
                                            <span fxFlex="5%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.id ?? '-'">
                                                {{projectLine.value.id ?? '-'}}
                                            </span>
                                            <span fxFlex="17%" class="u-w--100 text-truncate-ellipsis__multilne workflow-contracts--list-item" [matTooltip]="projectLine.value.projectName ?? '-'">
                                                {{projectLine.value.projectName ?? '-'}}
                                            </span>
                                            <span fxFlex="17%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.invoiceRecipientId?.name ?? '-'">
                                                {{projectLine.value.invoiceRecipientId?.name ?? '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.startDate ? (projectLine.value.startDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.startDate ? (projectLine.value.startDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.endDate ? (projectLine.value.endDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.endDate ? (projectLine.value.endDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.invoicingReferenceNumber ?? '-'">
                                                {{projectLine.value.invoicingReferenceNumber ?? '-'}}
                                            </span>
                                            <span fxFlex="7%" class="u-w--100 text-truncate-ellipsis workflow-contracts--list-item" [matTooltip]="projectLine.value.modificationDate ? (projectLine.value.modificationDate | momentFormat: 'DD.MM.YYYY') : '-'">
                                                {{projectLine.value.modificationDate ? (projectLine.value.modificationDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                            <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis__multilne workflow-contracts--list-item" [matTooltip]="projectLine.value.optionalInvoicingInfo ?? '-'">
                                                {{projectLine.value.optionalInvoicingInfo ?? '-'}}
                                            </span>
                                            <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100 workflow-contracts--list-item">
                                                <button mat-icon-button (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientFeeMenu" class="three-dots-actions-btn">
                                                    <mat-icon>more_horiz</mat-icon>
                                                </button>
                                                <mat-menu #clientFeeMenu>
                                                    <button
                                                        class="menu-item menu-item--edit"
                                                        mat-menu-item
                                                        (click)="duplicateProjectLine(consultantIndex, projectLinesIndex)">
                                                        <mat-icon>content_copy</mat-icon>
                                                        Duplicate
                                                    </button>
                                                    <button
                                                        class="menu-item menu-item--edit"
                                                        mat-menu-item
                                                        (click)="createOrEditProjectLine(consultantIndex, projectLinesIndex)">
                                                        <mat-icon>create</mat-icon>
                                                        Edit
                                                    </button>
                                                    <button
                                                        class="menu-item menu-item--cancel"
                                                        mat-menu-item
                                                        (click)="removeConsultantDataClientFees(consultantIndex, projectLinesIndex)">
                                                        <mat-icon>clear</mat-icon>
                                                        Remove
                                                    </button>
                                                </mat-menu>
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                                    <button [ngClass]="consultant.value.projectLines?.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button (click)="createOrEditProjectLine(consultantIndex)" *ngIf="!readOnlyMode">
                                        <mat-icon *ngIf="consultant.value.projectLines?.length">add</mat-icon>
                                        Add project line
                                    </button>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                </ng-container>
            </form>

            <form [formGroup]="contractsSyncDataForm" id="syncLegalContracts" class="workflow-form workflow-form--main u-w--100">
                <div fxLayout="column" fxLayoutAlign="start start" class="workflow-contracts--process-data u-w--100">
                    <h1 class="workflow-readonly--header-main">
                        <span class="process-name" *ngIf="readOnlyMode">Contracts.</span>
                        <span class="anchor-name">Sync & legal contracts</span>
                    </h1>
                    <h2 class="workflow-section--header u-mt--20">Sync</h2>

                    <ng-container *ngIf="readOnlyMode; else syncInput">
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--20">
                            <span class="icon-done u-mr--5">
                                <mat-icon svgIcon="completed-icon"></mat-icon>
                            </span>
                            <div fxLayout="column" fxLayoutAlign="start start">
                                <span class="workflow-darkblue--text">Synced to legacy system</span>
                                <span class="sync-hint-text">
                                    Last sync: 29.11.2021, 17:04
                                </span>
                            </div>
                        </div>
                    </ng-container>
                    <ng-template #syncInput>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <button class="button-accept u-mb--10" mat-flat-button>
                                Sync to legacy system
                            </button>
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--10">
                                <span class="icon-cancel u-mr--5">
                                    x
                                </span>
                                <span class="sync-hint-text">
                                    Sync not possible
                                </span>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-checkbox color="accent" formControlName="manualCheckbox" name="manualCheckbox" class="black-checkbox u-mt--10">
                                    Contract lines done manually in old PM
                                </mat-checkbox>
                            </div>
                        </div>
                    </ng-template>

                    <mat-divider class="u-w--100"></mat-divider>

                    <h2 class="workflow-section--header u-mb--20 u-mt--20">Legal contracts</h2>

                    <!-- hidden on Add Consultant -->
                    <ng-container *ngIf="activeSideSection !== workflowSideSections.StartConsultantPeriod">
                        <ng-container *ngIf="readOnlyMode; else legalContractsInput">
                            <h3 class="workflow-gray--header u-mb--10">Client legal contracts</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--20">
                                <span class="icon-done u-mr--5">
                                    <mat-icon svgIcon="completed-icon"></mat-icon>
                                </span>
                                <div fxLayout="column" fxLayoutAlign="start start">
                                    <span class="workflow-darkblue--text">Contract module for client</span>
                                    <span class="sync-hint-text">
                                        Complete
                                    </span>
                                </div>
                            </div>
                        </ng-container>
                        <ng-template #legalContractsInput>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-mb--20">
                                <span [ngClass]="{'workflow-gray--header': readOnlyMode, 'workflow-darkblue--text': !readOnlyMode}">Client legal contracts</span>
                                <div fxlayout="row" fxLayoutAlign="start center" class="u-mb--10 u-mt--10">
                                    <button class="button-accept u-mr--20" disabled mat-flat-button>
                                        Open contract module for client
                                    </button>
                                    <mat-checkbox *ngIf="activeSideSection === workflowSideSections.ChangeClientPeriod" color="accent" formControlName="newLegalContract" name="newLegalContract" class="black-checkbox u-mt--10">
                                        New legal contract needed
                                    </mat-checkbox>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20">
                                    <span class="icon-done u-mr--5">
                                        <mat-icon svgIcon="completed-icon"></mat-icon>
                                    </span>
                                    <span class="sync-hint-text">
                                        Complete
                                    </span>
                                </div>
                            </div>
                        </ng-template>
                    </ng-container>

                    <div fxLayout="column" fxLayoutAlign="start start" class="u-mb--20">
                        <span class="u-mt--20" [ngClass]="{'workflow-gray--header': readOnlyMode, 'workflow-darkblue--text': !readOnlyMode}">Consultant legal contracts</span>
                        <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20 u-mt--10">
                            <img class="workflow-contracts--consultant-img u-mr--16" src="https://placekitten.com/50/50">
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <p class="workflow-contracts--consultant-name">
                                    <!-- {{contractsConsultantsDataForm.consultants.at(i).get('consultantName')?.value}} -->
                                    Robertsen Oscar
                                </p>
                                <div fxLayout="row" fxLayoutAlign="start center" *ngIf="readOnlyMode">
                                    <span class="icon-done u-mr--5">
                                        <mat-icon svgIcon="completed-icon"></mat-icon>
                                    </span>
                                    <div fxLayout="column" fxLayoutAlign="start start">
                                        <span class="workflow-darkblue--text">Contract module for consultant - complete</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div fxlayout="row" fxLayoutAlign="start center" class="u-mb--10" *ngIf="!readOnlyMode">
                            <button class="button-outlined  u-mr--20" disabled mat-flat-button>
                                Open contract module for consultant
                            </button>
                            <mat-checkbox *ngIf="activeSideSection === workflowSideSections.ChangeClientPeriod" color="accent" formControlName="newLegalContract" name="newLegalContract" class="black-checkbox u-mt--10">
                                New legal contract needed
                            </mat-checkbox>
                        </div>

                        <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20" *ngIf="!readOnlyMode">
                            <span class="icon-done u-mr--5">
                                <mat-icon svgIcon="completed-icon"></mat-icon>
                            </span>
                            <span class="sync-hint-text">
                                Complete
                            </span>
                        </div>

                        <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20">
                            <img class="workflow-contracts--consultant-img u-mr--16" src="https://placekitten.com/50/50">
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <p class="workflow-contracts--consultant-name">
                                    <!-- {{contractsConsultantsDataForm.consultants.at(i).get('consultantName')?.value}} -->
                                    Van Trier Mia
                                </p>
                                <div fxLayout="row" fxLayoutAlign="start center" *ngIf="readOnlyMode">
                                    <span class="icon-done u-mr--5">
                                        <mat-icon svgIcon="completed-icon"></mat-icon>
                                    </span>
                                    <div fxLayout="column" fxLayoutAlign="start start">
                                        <span class="workflow-darkblue--text">Contract module for consultant - complete</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div fxlayout="row" fxLayoutAlign="start center" class="u-mb--10" *ngIf="!readOnlyMode">
                            <button class="button-outlined  u-mr--20" disabled mat-flat-button>
                                Open contract module for client
                            </button>
                            <mat-checkbox *ngIf="activeSideSection === workflowSideSections.ChangeClientPeriod" color="accent" formControlName="newLegalContract" name="newLegalContract" class="black-checkbox u-mt--10">
                                New legal contract needed
                            </mat-checkbox>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20" *ngIf="!readOnlyMode">
                            <span class="icon-in-progress u-mr--5">
                                <mat-icon svgIcon="in-progress-icon"></mat-icon>
                            </span>
                            <span class="sync-hint-text">
                                In progress
                            </span>
                        </div>
                    </div>
                </div>
            </form>
        </ng-container>
    </ng-container>
</div>
