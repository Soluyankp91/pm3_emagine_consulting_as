<div class="workflow-sales">
    <button class="absolute-edit-toggle" mat-icon-button *ngIf="canToggleEditMode" type="button" (click)="toggleEditMode()"><mat-icon>{{readOnlyMode ? 'create' : 'close'}}</mat-icon></button>
    <ng-container *ngIf="readOnlyMode; else editMode">
        <ng-container *ngIf="(activeSideSection.typeId !== workflowSideSections.TerminateWorkflow) && (activeSideSection.typeId !== workflowSideSections.TerminateConsultant); else terminationTemplate">
            <!-- Main data -->
            <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100" id="salesMainDataAnchor">
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h1 class="workflow-step-readonly--header-main">
                        <span class="process-name">Sales.</span>
                        <span class="anchor-name">Main data</span>
                    </h1>
                    <h2 class="workflow-step-readonly--header u-mt--10 u-mb--20">Project</h2>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Project Type (Legacy)</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.projectType?.value?.name ? salesMainDataForm?.projectType?.value?.name : '-' }}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Sales Type</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.salesType?.value?.name ? salesMainDataForm?.salesType?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Delivery Type</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.deliveryType?.value?.name ? salesMainDataForm?.deliveryType?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Margin</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.margin?.value?.name ? salesMainDataForm?.margin?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>

                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Project Category</h3>
                        <span class="workflow-step-readonly--blue-text-bold">
                            {{salesMainDataForm?.projectCategory?.value?.name ? salesMainDataForm?.projectCategory?.value?.name : '-'}}
                        </span>
                    </div>

                    <div fxLayout="column" class="u-w--100 u-mb--10">
                        <h3 class="workflow-step-readonly--gray-header">Project Description</h3>
                        <p class="workflow-step-readonly--blue-text">
                            {{salesMainDataForm?.projectDescription?.value ? salesMainDataForm?.projectDescription?.value : '-'}}
                        </p>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Invoicing</h2>
                    <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                        <h3 class="workflow-step-readonly--gray-header">Discounts</h3>
                        <span class="workflow-step-readonly--blue-text-bold">
                            {{salesMainDataForm?.discounts?.value ? salesMainDataForm?.discounts?.value?.name : '-'}}
                        </span>
                    </div>
                    <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                        <h3 class="workflow-step-readonly--blue-header">Commission</h3>
                        <div class="inline-edit-form u-w--100">
                            <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesMainDataForm.commissions?.controls?.length">
                                <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                    Type
                                </span>
                                <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                    Value
                                </span>
                                <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                    Currency
                                </span>
                                <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                    Recipient type
                                </span>
                                <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                    Recipient
                                </span>
                                <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                    Frequency
                                </span>
                            </div>
                            <ng-container class="u-w--100">
                                <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                    *ngFor="let commission of salesMainDataForm.commissions.controls; index as i">
                                    <ng-container *ngIf="!commission.value.editable">
                                        <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('type')?.value?.name" matTooltipClass="white-tooltip">
                                            {{commission.value.type?.name}}
                                        </span>
                                        <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('value')?.value" matTooltipClass="white-tooltip">
                                            {{commission.value.value}}
                                        </span>
                                        <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('currency')?.value?.name" matTooltipClass="white-tooltip">
                                            {{commission.value.currency?.name}}
                                        </span>
                                        <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('recipientType')?.value?.name" matTooltipClass="white-tooltip">
                                            {{commission.value.recipientType?.name}}
                                        </span>
                                        <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('recipient')?.value?.name" matTooltipClass="white-tooltip">
                                            <ng-container [ngSwitch]="commission.value.recipientType?.name">
                                                <ng-container *ngSwitchCase="'Client'">
                                                    <div fxLayout="row" fxLayoutAlign="start center">
                                                        <div fxLayout="column" fxLayoutAlign="start start">
                                                            <span>
                                                                {{commission.value.recipient?.clientName}}
                                                            </span>
                                                            <span>
                                                                {{commission.value.recipient?.clientId ? '#' + commission.value.recipient?.clientId + ' | ' : ''}}
                                                                {{commission.value.recipient?.city ? commission.value.recipient?.city + ' | ' : ''}}
                                                                {{commission.value.recipient?.address ? commission.value.recipient?.address + ' | ' : ''}}
                                                                {{commission.value.recipient?.address2 ? commission.value.recipient?.address2 + ' | ' : ''}}
                                                                {{commission.value.recipient?.postCode}}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="'Consultant'">
                                                    <div fxLayout="row" fxLayoutAlign="start center">
                                                        <div fxLayout="column" fxLayoutAlign="start start">
                                                            <span>
                                                                {{commission.value.recipient?.name}}
                                                            </span>
                                                            <span>
                                                                {{commission.value.recipient?.companyName ? commission.value.recipient?.companyName + ' | ' : ''}}
                                                                {{commission.value.recipient?.city ? commission.value.recipient?.city + ' | ' : ''}}
                                                                #{{commission.value.recipient?.id}} / {{getTenantCodeFromId(commission.value.recipient?.tenantId) + '-' +commission.value.recipient?.legacyId}}
                                                            </span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="'Supplier'">
                                                    {{commission.value.recipient?.supplierName}}
                                                </ng-container>
                                                <ng-container *ngSwitchCase="'PDC entity'">
                                                    {{commission.value.recipient?.name}}
                                                </ng-container>
                                            </ng-container>
                                        </span>
                                        <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('frequency')?.value?.name" matTooltipClass="white-tooltip">
                                            <!-- frequency id === 2 -- 'One time' -->
                                            <ng-container *ngIf="salesMainDataForm.commissions.at(i).get('frequency')?.value?.id === 2; else commissionFrequency">
                                                {{salesMainDataForm.commissions.at(i).get('frequency')?.value?.name}} {{salesMainDataForm.commissions.at(i).get('oneTimeDate')?.value | momentFormat: 'DD.MM.YYYY'}}
                                            </ng-container>
                                            <ng-template #commissionFrequency>
                                                {{salesMainDataForm.commissions.at(i).get('frequency')?.value?.name}}
                                            </ng-template>
                                        </span>
                                    </ng-container>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Account manager</h2>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-mb--10" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Sales Account Manager</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.salesAccountManagerIdValue?.value?.name ? salesMainDataForm?.salesAccountManagerIdValue?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-mb--10" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Commission Manager Type</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.commissionAccountManagerIdValue?.value?.name ? salesMainDataForm?.commissionAccountManagerIdValue?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-mb--10" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Contract Expiration Notification</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{contractExpirationNotificationDisplay}}
                            </span>
                        </div>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--10" fxFlex="25%" *ngIf="salesMainDataForm.contractExpirationNotification?.value?.includes(999)">
                            <h3 class="workflow-step-readonly--gray-header">Manual date</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.customContractExpirationNotificationDate?.value | momentFormat: 'DD.MM.YYYY'}}
                            </span>
                        </div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                            <h3 class="workflow-step-readonly--gray-header">Remarks</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesMainDataForm?.noRemarks?.value ? 'No remarks' : salesMainDataForm?.remarks?.value}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <mat-divider></mat-divider>
            <!-- Client data -->
            <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100">
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100" id="salesClientDataAnchor">
                    <h1 class="workflow-step-readonly--header-main u-mb--10">
                        <span class="process-name">Sales.</span>
                        <span class="anchor-name">Client data</span>
                    </h1>

                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Client relation</h3>
                        <span class="workflow-step-readonly--blue-text-bold">
                            {{salesClientDataForm?.differentEndClient?.value ? 'Different end-client' : 'Direct Client'}}
                        </span>
                    </div>

                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="50%">
                            <h3 class="workflow-step-readonly--gray-header">Direct client</h3>
                            <div fxLayout="row" fxLayoutAlign="start center" *ngIf="salesClientDataForm?.directClientIdValue?.value; else noDataTemplate">
                                <div fxLayout="column" fxLayoutAlign="start start">
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{salesClientDataForm?.directClientIdValue?.value?.clientName}}
                                    </span>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{salesClientDataForm?.directClientIdValue?.value?.clientId ? '#' + salesClientDataForm?.directClientIdValue?.value?.clientId + ' | ' : '' }}
                                        {{salesClientDataForm?.directClientIdValue?.value?.city ? salesClientDataForm?.directClientIdValue?.value?.city + ' | ' : ''}}
                                        {{salesClientDataForm?.directClientIdValue?.value?.address ? salesClientDataForm?.directClientIdValue?.value?.address + ' | ' : ''}}
                                        {{salesClientDataForm?.directClientIdValue?.value?.address2 ? salesClientDataForm?.directClientIdValue?.value?.address2 + ' | ' : ''}}
                                        {{salesClientDataForm?.directClientIdValue?.value?.postCode}}
                                    </span>
                                </div>
                            </div>
                            <ng-template #noDataTemplate>
                                <span class="workflow-step-readonly--blue-text-bold">
                                    -
                                </span>
                            </ng-template>
                        </div>
                        <div fxLayout="column" fxFlex="50%" *ngIf="salesClientDataForm?.endClientIdValue?.value">
                            <h3 class="workflow-step-readonly--gray-header">End client</h3>
                            <div fxLayout="row" fxLayoutAlign="start center">
                                <div fxLayout="column" fxLayoutAlign="start start">
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{salesClientDataForm?.endClientIdValue?.value?.clientName}}
                                    </span>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{salesClientDataForm?.endClientIdValue?.value?.clientId ? '#' + salesClientDataForm?.endClientIdValue?.value?.clientId + ' | ' : '' }}
                                        {{salesClientDataForm?.endClientIdValue?.value?.city ? salesClientDataForm?.endClientIdValue?.value?.city + ' | ' : ''}}
                                        {{salesClientDataForm?.endClientIdValue?.value?.address ? salesClientDataForm?.endClientIdValue?.value?.address + ' | ' : ''}}
                                        {{salesClientDataForm?.endClientIdValue?.value?.address2 ? salesClientDataForm?.endClientIdValue?.value?.address2 + ' | ' : ''}}
                                        {{salesClientDataForm?.endClientIdValue?.value?.postCode}}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Client contract duration</h2>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Start date</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientContractStartDate?.value ? (salesClientDataForm?.clientContractStartDate?.value | momentFormat: 'DD.MM.YYYY') : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">End date</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientContractNoEndDate?.value ? 'No end date' : (salesClientDataForm?.clientContractEndDate?.value ? (salesClientDataForm?.clientContractEndDate?.value | momentFormat: 'DD.MM.YYYY') : '-')}}
                            </span>
                        </div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Option to extend</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.noClientExtensionOption?.value ? 'No option' : 'Option to extend'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Duration</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientExtensionDuration?.value?.name ? salesClientDataForm?.clientExtensionDuration?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Deadline</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientExtensionDeadline?.value?.name ? salesClientDataForm?.clientExtensionDeadline?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Client invoicing</h2>
                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Invoicing Entity</h3>
                        <span class="workflow-step-readonly--blue-text-bold">
                            {{salesClientDataForm?.pdcInvoicingEntityId?.value?.name ? salesClientDataForm?.pdcInvoicingEntityId?.value?.name : '-'}}
                        </span>
                    </div>
                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Rate</h3>
                        <span class="workflow-step-readonly--blue-text-bold">
                            {{salesClientDataForm?.clientRateAndInvoicing?.value?.name ? salesClientDataForm?.clientRateAndInvoicing?.value?.name : '-'}}
                        </span>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Price</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientPrice?.value ? salesClientDataForm?.clientPrice?.value : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Unit type</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.rateUnitTypeId?.value?.name ? salesClientDataForm?.rateUnitTypeId?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Currency</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientCurrency?.value?.name ? salesClientDataForm?.clientCurrency?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Invoicing ref. no.</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.invoicingReferenceNumber?.value ? salesClientDataForm?.invoicingReferenceNumber?.value : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Invoice currency</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientInvoiceCurrency?.value?.name ? salesClientDataForm?.clientInvoiceCurrency?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Invoicing frequency</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.clientInvoiceFrequency?.value?.name ? salesClientDataForm?.clientInvoiceFrequency?.value?.name : '-'}}
                            </span>
                        </div>
                    </div>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Client Invoicing recipient</h3>
                            <span class="workflow-step-readonly--blue-text-bold" *ngIf="salesClientDataForm?.clientInvoicingRecipientSameAsDirectClient?.value === true; else clientInvoicingRecipientTemplate">
                                Same as client
                            </span>
                            <ng-template #clientInvoicingRecipientTemplate>
                                <div fxLayout="row" fxLayoutAlign="start center">
                                    <div fxLayout="column" fxLayoutAlign="start start" *ngIf="salesClientDataForm?.clientInvoicingRecipientIdValue?.value">
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.clientName}}
                                        </span>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.clientId ? '#' + salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.clientId + ' | ' : ''}}
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.city ? salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.city + ' | ' : ''}}
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.address ? salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.address + ' | ' : ''}}
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.address2 ? salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.address2 + ' | ' : ''}}
                                            {{salesClientDataForm?.clientInvoicingRecipientIdValue?.value?.postCode}}
                                        </span>
                                    </div>
                                </div>
                            </ng-template>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Invoicing reference person</h3>
                            <span class="workflow-step-readonly--blue-text-bold" *ngIf="salesClientDataForm?.invoicingReferencePersonIdValue?.value; else noDataTemplate">
                                {{salesClientDataForm?.invoicingReferencePersonIdValue?.value?.firstName + ' ' + salesClientDataForm?.invoicingReferencePersonIdValue?.value?.lastName }}
                            </span>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Client project</h2>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Shared Cap on Time Reporting</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.capOnTimeReporting?.value?.name ? salesClientDataForm?.capOnTimeReporting?.value?.name : '-'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%" *ngIf="salesClientDataForm.capOnTimeReporting?.value?.id !== 3 && salesClientDataForm.capOnTimeReporting?.value?.id !== 4">
                            <h3 class="workflow-step-readonly--gray-header">Max. value</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.capOnTimeReportingValue?.value ? salesClientDataForm?.capOnTimeReportingValue?.value : '-'}}
                                <ng-container [ngSwitch]="salesClientDataForm?.capOnTimeReporting?.value?.id">
                                    <ng-container *ngSwitchCase="1"> <!-- Cap on units -->
                                        <ng-container [ngSwitch]="salesClientDataForm?.rateUnitTypeId?.value?.id">
                                            <ng-container *ngSwitchCase="1"> <!-- Per hour -->
                                                hours
                                            </ng-container>
                                            <ng-container *ngSwitchCase="2"> <!-- Per day -->
                                                days
                                            </ng-container>
                                            <ng-container *ngSwitchCase="3"> <!-- Per month -->
                                                months
                                            </ng-container>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="2"> <!-- Cap on value -->
                                        {{salesClientDataForm?.clientCurrency?.value?.name ? salesClientDataForm?.clientCurrency?.value?.name : '-'}}
                                    </ng-container>
                                </ng-container>
                            </span>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">CLIENT RATES AND FEES</h2>
                    <div class="inline-edit-form u-w--100 u-mb--20">
                        <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesClientDataForm.clientRates?.controls?.length; else noDataTemplate">
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Rate name
                            </span>
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Reporting unit
                            </span>
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Client rate
                            </span>
                        </div>
                        <ng-container class="u-w--100">
                            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                *ngFor="let rate of salesClientDataForm.clientRates.controls; index as i">
                                <ng-container>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.rateName" matTooltipClass="white-tooltip">
                                        {{rate.value.rateName ?? '-'}}
                                    </span>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.reportingUnit?.name" matTooltipClass="white-tooltip">
                                        {{rate.value.reportingUnit?.name ?? '-'}}
                                    </span>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.clientRateValue + ' ' + rate.value.clientRateCurrency?.name" matTooltipClass="white-tooltip">
                                        {{rate.value.clientRateValue || rate.value.clientRateCurrency?.name ? rate.value.clientRateValue + ' ' + rate.value.clientRateCurrency?.name : '-'}}
                                    </span>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                    <div class="inline-edit-form u-w--100">
                        <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesClientDataForm.clientFees?.controls?.length; else noDataTemplate">
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Fee name
                            </span>
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Frequency
                            </span>
                            <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                Client fee
                            </span>
                        </div>
                        <ng-container class="u-w--100">
                            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                *ngFor="let fee of salesClientDataForm.clientFees.controls; index as i">
                                <ng-container>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeName ?? '-'" matTooltipClass="white-tooltip">
                                        {{fee.value.feeName ?? '-'}}
                                    </span>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeFrequency?.name ?? '-'" matTooltipClass="white-tooltip">
                                        {{fee.value.feeFrequency?.name ?? '-'}}
                                    </span>
                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.clientRateValue + ' ' + fee.value.clientRateCurrency?.name" matTooltipClass="white-tooltip">
                                        {{fee.value.clientRateValue || fee.value.clientRateCurrency?.name ? fee.value.clientRateValue + ' ' + fee.value.clientRateCurrency?.name : '-'}}
                                    </span>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Client evaluation</h2>
                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Evaluations</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.evaluationsDisabled?.value ? 'Disabled' : 'Enabled'}}
                            </span>
                        </div>
                        <div fxLayout="column" fxFlex="25%">
                            <h3 class="workflow-step-readonly--gray-header">Evaluations Reference Person</h3>
                            <span class="workflow-step-readonly--blue-text-bold">
                                {{salesClientDataForm?.evaluationsReferencePersonIdValue?.value ? salesClientDataForm?.evaluationsReferencePersonIdValue?.value?.firstName + ' ' + salesClientDataForm?.evaluationsReferencePersonIdValue?.value?.lastName : '-'}}
                            </span>
                        </div>
                    </div>
                </div>
                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                    <h2 class="workflow-step-readonly--header u-mb--20">Client contract</h2>
                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Special Contract Terms</h3>
                        <span class="workflow-step-readonly--blue-text">
                            {{salesClientDataForm?.specialContractTerms?.value ? salesClientDataForm?.specialContractTerms?.value : '-'}}
                        </span>
                    </div>
                    <div fxLayout="column" class="u-w--100 u-mb--20">
                        <h3 class="workflow-step-readonly--gray-header">Contract Signers</h3>
                        <ng-container *ngIf="salesClientDataForm?.contractSigners?.controls?.length; else noDataTemplate">
                            <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="25px">
                                <h3 class="workflow-step-readonly--gray-header" fxFlex="25%">
                                    Name
                                </h3>
                                <h3 class="workflow-step-readonly--gray-header" fxFlex="25%">
                                    Client role
                                </h3>
                                <h3 class="workflow-step-readonly--gray-header" fxFlex="25%">
                                    Sequence
                                </h3>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="25px" *ngFor="let item of salesClientDataForm?.contractSigners?.controls">
                                <span class="workflow-step-readonly--blue-text-bold" fxFlex="25%">
                                    {{item?.value?.clientContact?.firstName + ' ' + item?.value?.clientContact?.lastName}}
                                </span>
                                <span class="workflow-step-readonly--blue-text-bold" fxFlex="25%">
                                    {{item?.value?.clientRole?.name}}
                                </span>
                                <span class="workflow-step-readonly--blue-text-bold" fxFlex="25%">
                                    {{item?.value?.clientSequence}}
                                </span>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <mat-divider></mat-divider>
            <!-- Consultant data -->
            <form [formGroup]="consultantsForm">
                <ng-container formArrayName="consultantData" class="u-mb--20">
                    <ng-container *ngFor="let item of consultantsForm.consultantData.controls; index as consultantIndex" [formGroupName]="consultantIndex">
                        <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100" [id]="'salesConsultantDataAnchor' + consultantIndex">
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                    <h1 class="workflow-step-readonly--header-main" fxFlex="50%">
                                        <span class="process-name">Sales.</span>
                                        <span class="anchor-name">Consultant data</span>
                                    </h1>
                                    <!-- Only visible when employment type is selected and it is not 'Fee only' - id: 10 nd not 'Recruitment' - id:11 -->
                                    <div fxFlex="50%" fxLayoutAlign="end center" *ngIf="item.value?.employmentType?.id !== 10 && item.value?.employmentType?.id !== 11;">
                                        <button *ngIf="individualConsultantActionsAvailable" mat-icon-button (click)="$event.stopPropagation();" type="button" [matMenuTriggerFor]="consultantMenu" class="three-dots-actions-btn">
                                            <mat-icon>more_horiz</mat-icon>
                                        </button>
                                        <mat-menu #consultantMenu>
                                            <button
                                                class="menu-item menu-item--edit"
                                                mat-menu-item
                                                (click)="changeConsultantData(consultantIndex)">
                                                <mat-icon>create</mat-icon>
                                                Change consultant data
                                            </button>
                                            <button
                                                class="menu-item menu-item--edit"
                                                mat-menu-item
                                                (click)="extendConsultant(consultantIndex)">
                                                <mat-icon>add</mat-icon>
                                                Extend consultant
                                            </button>
                                            <button
                                                class="menu-item menu-item--cancel"
                                                mat-menu-item
                                                (click)="terminateConsultant(consultantIndex)">
                                                <mat-icon>clear</mat-icon>
                                                Terminate consultant
                                            </button>
                                        </mat-menu>
                                    </div>
                                </div>

                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Employment type</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.employmentType?.name ? item?.value?.employmentType?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column">
                                        <h3 class="workflow-step-readonly--gray-header">Consultant</h3>
                                        <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20">
                                            <img class="border-rounded-50 image-thumbnail-responsive u-mr--16" [src]="consultantProfileUrl(item.value.consultantName?.consultant?.externalId)" >
                                            <div fxLayout="column">
                                                <p class="workflow-extension--consultant-data--consultant-name">
                                                    {{item?.value?.consultantName?.consultant?.name}}
                                                </p>
                                                <span class="workflow-extension--consultant-data--consultant-text">
                                                    {{item?.value?.consultantName?.consultant?.companyName}} | {{item?.value?.consultantName?.consultant?.city}}, {{getTenantCodeFromId(item?.value?.consultantName?.consultant?.countryId)}} | #{{item?.value?.consultantName?.consultant?.id}} / {{getTenantCodeFromId(item?.value?.consultantName?.consultant?.countryId)}}-{{item?.value?.consultantName?.consultant?.legacyId}}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <h2 class="workflow-step-readonly--header u-mb--20">Consultant contract duration</h2>
                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">Project Duration</h3>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{item?.value?.consultantProjectDurationSameAsClient ? ' Same as client' : 'Different from client'}}
                                    </span>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Start date</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantProjectStartDate ? (item?.value?.consultantProjectStartDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">End date</h3>
                                        <span class="workflow-step-readonly--blue-text-bold" *ngIf="item?.value?.consultantProjectNoEndDate; else consultantProjectEndDateTemplate">
                                            No end date
                                        </span>
                                        <ng-template #consultantProjectEndDateTemplate>
                                            <span class="workflow-step-readonly--blue-text-bold">
                                                {{item?.value?.consultantProjectEndDate ? (item?.value?.consultantProjectEndDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                            </span>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                            <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <h2 class="workflow-step-readonly--header u-mb--20">Consultant payment</h2>
                                <div fxLayout="column" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">ProData Entity</h3>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{item?.value?.consultantProdataEntity?.name ? item?.value?.consultantProdataEntity?.name : '-'}}
                                    </span>
                                </div>
                                <div fxLayout="column" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">Rate</h3>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{item?.value?.consultantPaymentType?.name ? item?.value?.consultantPaymentType?.name : '-'}}
                                    </span>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Price</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantRate ? item?.value?.consultantRate : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Unit type</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantRateUnitType?.name ? item?.value?.consultantRateUnitType?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Currency</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantRateCurrency?.name ? item?.value?.consultantRateCurrency?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxFlex="25%" fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                        <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === item.value?.consultantPaymentType?.id) &&
                                                (salesClientDataForm.clientCurrency?.value?.id === item.value?.consultantRateCurrency?.id) &&
                                                (salesClientDataForm.rateUnitTypeId?.value?.id === item.value?.consultantRateUnitType?.id) &&
                                                (salesClientDataForm.clientPrice?.value && item.value?.consultantRate); else calculateMarginNotPossible">
                                                <ng-container *ngIf="item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id; else consultantMargin">
                                                    <ng-container *ngIf="item?.value?.consultantPDCRate; else calculateMarginNotPossible">
                                                        Calculated margin
                                                        {{ (item?.value?.consultantPDCRate * 1 -  item.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                    </ng-container>
                                                </ng-container>
                                                <ng-template #consultantMargin>
                                                    Calculated margin
                                                    {{ (salesClientDataForm.clientPrice?.value * 1 -  item.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                </ng-template>
                                        </span>
                                        <ng-template #calculateMarginNotPossible>
                                            Calculate margin is not possible
                                        </ng-template>
                                    </div>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20" *ngIf="(item.value?.consultantProdataEntity?.id && salesClientDataForm.value?.pdcInvoicingEntityId?.id) && (item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">PDC-to-PDC rate</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantPDCRate ? item?.value?.consultantPDCRate : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Unit type</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantPDCRateUnitType?.name ? item?.value?.consultantPDCRateUnitType?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Currency</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantPDCRateCurrency?.name ? item?.value?.consultantPDCRateCurrency?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxFlex="25%" fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                        <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === item.value?.consultantPaymentType?.id) &&
                                                (salesClientDataForm.clientCurrency?.value?.id === item.value?.consultantPDCRateCurrency?.id) &&
                                                (salesClientDataForm.rateUnitTypeId?.value?.id === item.value?.consultantPDCRateUnitType?.id) &&
                                                (salesClientDataForm.clientPrice?.value && item.value?.consultantPDCRate); else calculatePDCMarginNotPossible">
                                                    Calculated margin
                                                    {{ (salesClientDataForm.clientPrice?.value * 1 -  item?.value?.consultantPDCRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                        </span>
                                        <ng-template #calculatePDCMarginNotPossible>
                                            Calculate margin is not possible
                                        </ng-template>
                                    </div>
                                </div>
                                <ng-container *ngIf="item.value?.consultantPaymentType?.id === 2 ||
                                            ((salesClientDataForm.value?.pdcInvoicingEntityId?.id && item.value?.consultantProdataEntity?.id) &&
                                            (item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)) ||
                                            (salesClientDataForm.clientRateAndInvoicing?.value?.id !== item.value?.consultantPaymentType?.id)">
                                            <h3 class="workflow-step-readonly--gray-header">Invoicing information</h3>
                                </ng-container>
                                <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                    <ng-container [ngSwitch]="item.value?.consultantPaymentType?.id">
                                        <ng-container *ngSwitchCase="1"> <!-- Time based -->
                                            <div fxLayout="column" fxFlex="25%" *ngIf="salesClientDataForm.clientRateAndInvoicing?.value?.id === 2">
                                                <h3 class="workflow-step-readonly--gray-header">Invoicing frequency</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantInvoicingFrequency ? item?.value?.consultantInvoicingFrequency?.name : '-'}}
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="25%" *ngIf="item.value.consultantInvoicingFrequency?.name === 'Manual date'">
                                                <h3 class="workflow-step-readonly--gray-header">Date</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantInvoicingManualDate ? (item?.value?.consultantInvoicingManualDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                                </span>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="2"> <!-- Fixed -->
                                            <div fxLayout="column" fxFlex="25%" *ngIf="salesClientDataForm.clientRateAndInvoicing?.value?.id === 2">
                                                <h3 class="workflow-step-readonly--gray-header">Invoicing time</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantInvoicingTime ? item?.value?.consultantInvoicingTime?.name : '-'}}
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="25%" *ngIf="item.value?.consultantInvoicingTime?.name === 'Manual date'">
                                                <h3 class="workflow-step-readonly--gray-header">Date</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantInvoicingManualDate ? (item?.value?.consultantInvoicingManualDate | momentFormat: 'DD.MM.YYYY') : '-'}}
                                                </span>
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" >
                                    <div fxLayout="column" fxFlex="25%"*ngIf="(salesClientDataForm.value?.pdcInvoicingEntityId?.id && item.value?.consultantProdataEntity?.id) && (item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                        <h3 class="workflow-step-readonly--gray-header">PDC invoicing currency</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.prodataToProdataInvoiceCurrency ? item?.value?.prodataToProdataInvoiceCurrency?.name : '-'}}
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <h2 class="workflow-step-readonly--header u-mb--20">Consultant project</h2>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <div fxLayout="column" fxFlex="50%">
                                        <div fxLayout="row" class="u-w--100 u-mb--10" *ngIf="item?.value?.consultantIsOnsiteWorkplace">
                                            <div fxLayout="column" fxFlex="30%">
                                                <h3 class="workflow-step-readonly--gray-header">Workplace</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    Onsite
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="40%">
                                                <h3 class="workflow-step-readonly--gray-header">Client address</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item.value.consultantWorkplaceClientAddress?.countryName}} | {{item.value.consultantWorkplaceClientAddress?.address}} | {{item.value.consultantWorkplaceClientAddress?.address2}} | {{item.value.consultantWorkplaceClientAddress?.postCode}}
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="30%" *ngIf="item?.value?.consultantWorkplacePercentageOnSite">
                                                <h3 class="workflow-step-readonly--gray-header">Percentage onsite</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantWorkplacePercentageOnSite ? item?.value?.consultantWorkplacePercentageOnSite : '-'}}
                                                </span>
                                            </div>
                                        </div>
                                        <div fxLayout="row" class="u-w--100 u-mb--10" *ngIf="item?.value?.consultantIsEmagineOfficeWorkplace">
                                            <div fxLayout="column" fxFlex="30%">
                                                <h3 class="workflow-step-readonly--gray-header">Workplace</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    PDC Office
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="40%">
                                                <h3 class="workflow-step-readonly--gray-header">Office location</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantWorkplaceEmagineOffice?.name}}
                                                </span>
                                            </div>
                                        </div>
                                        <div fxLayout="row" class="u-w--100" *ngIf="item?.value?.consultantIsRemoteWorkplace">
                                            <div fxLayout="column" fxFlex="30%">
                                                <h3 class="workflow-step-readonly--gray-header">Workplace</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    Remote
                                                </span>
                                            </div>
                                            <div fxLayout="column" fxFlex="40%">
                                                <h3 class="workflow-step-readonly--gray-header">Office location</h3>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    {{item?.value?.consultantWorkplaceRemote}}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div fxLayout="column" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">Expected workload</h3>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{item?.value?.expectedWorkloadHours ? item?.value?.expectedWorkloadHours : '-'}} {{item?.value?.expectedWorkloadUnitId?.name ? item?.value?.expectedWorkloadUnitId.name : ''}}
                                    </span>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20" *ngIf="salesClientDataForm.capOnTimeReporting?.value?.id === 3">
                                    <div fxLayout="column" class="u-w--100 u-mb--20" fxFlex="25%">
                                        <h3 class="workflow-step-readonly--gray-header">Cap on Time Reporting</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantCapOnTimeReporting ? item?.value?.consultantCapOnTimeReporting?.name : '-'}}
                                        </span>
                                    </div>
                                    <div fxLayout="column" fxFlex="25%" *ngIf="item?.value?.consultantCapOnTimeReporting?.id !== 4">
                                        <h3 class="workflow-step-readonly--gray-header">Max. value</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{item?.value?.consultantTimeReportingCapMaxValue ? item?.value?.consultantTimeReportingCapMaxValue : '-'}}
                                            <ng-container [ngSwitch]="item?.value?.consultantCapOnTimeReporting?.id">
                                                <ng-container *ngSwitchCase="1"> <!-- Cap on units -->
                                                    <ng-container [ngSwitch]="item?.value?.consultantRateUnitType?.id">
                                                        <ng-container *ngSwitchCase="1"> <!-- Per hour -->
                                                            hours
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="2"> <!-- Per day -->
                                                            days
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="3"> <!-- Per month -->
                                                            months
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="2"> <!-- Cap on value -->
                                                    {{item?.value?.consultantRateCurrency?.name ? item?.value?.consultantRateCurrency?.name : '-'}}
                                                </ng-container>
                                            </ng-container>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <h2 class="workflow-section--header">Rates and fees</h2>

                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="item.value.specialRates?.length">
                                        <span fxFlex="1 1 20%" class="workflow-sales-inline--form__header u-w--100">
                                            Rate name
                                        </span>
                                        <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                            Reporting unit
                                        </span>
                                        <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100" *ngIf="item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                            ProData rate
                                        </span>
                                        <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                            Consultant rate
                                        </span>
                                    </div>
                                    <ng-container formArrayName="specialRates" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                            *ngFor="let rate of getConsultantRateControls(consultantIndex); let specialRateIndex = index;"
                                            [formArrayName]="specialRateIndex">
                                            <ng-container>
                                                <span fxFlex="1 1 20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.rateName" matTooltipClass="white-tooltip">
                                                    {{rate.value.rateName ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.reportingUnit?.name" matTooltipClass="white-tooltip">
                                                    {{rate.value.reportingUnit?.name ?? '-'}}
                                                </span>
                                                <ng-container *ngIf="item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.prodataToProdataRate + ' ' + rate.value.prodataToProdataRateCurrency?.name" matTooltipClass="white-tooltip">
                                                        {{rate.value.prodataToProdataRate || rate.value.prodataToProdataRateCurrency?.name ? rate.value.prodataToProdataRate + ' ' + rate.value.prodataToProdataRateCurrency?.name : '-'}}
                                                    </span>
                                                </ng-container>
                                                <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.consultantRate + ' ' + rate.value.consultantRateCurrency?.name" matTooltipClass="white-tooltip">
                                                    {{rate.value.consultantRate || rate.value.consultantRateCurrency?.name ? rate.value.consultantRate + ' ' + rate.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>

                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="item.value.specialFees?.length">
                                        <span fxFlex="1 1 20%" class="workflow-sales-inline--form__header u-w--100">
                                            Fee name
                                        </span>
                                        <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                            Frequency
                                        </span>
                                        <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100" *ngIf="item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                            ProData fee
                                        </span>
                                        <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                            Consultant fee
                                        </span>
                                    </div>
                                    <ng-container formArrayName="specialFees" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                            *ngFor="let fee of getConsultantFeeControls(consultantIndex); let specialFeeIndex = index;"
                                            [formArrayName]="specialFeeIndex">
                                            <ng-container>
                                                <span fxFlex="1 1 20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeName ?? '-'" matTooltipClass="white-tooltip">
                                                    {{fee.value.feeName ?? '-'}}
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.frequency?.name ?? '-'" matTooltipClass="white-tooltip">
                                                    {{fee.value.frequency?.name ?? '-'}}
                                                </span>
                                                <ng-container *ngIf="item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                    <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.prodataToProdataRate + ' ' + fee.value.prodataToProdataRateCurrency?.name" matTooltipClass="white-tooltip">
                                                        {{fee.value.prodataToProdataRate || fee.value.prodataToProdataRateCurrency?.name ? fee.value.prodataToProdataRate + ' ' + fee.value.prodataToProdataRateCurrency?.name : '-'}}
                                                    </span>
                                                </ng-container>
                                                <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.consultantRate + ' ' + fee.value.consultantRateCurrency?.name" matTooltipClass="white-tooltip">
                                                    {{fee.value.consultantRate || fee.value.consultantRateCurrency?.name ? fee.value.consultantRate + ' ' + fee.value.consultantRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-container>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>

                            <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <h2 class="workflow-step-readonly--header u-mb--20">Consultant contract</h2>
                                <div fxLayout="column" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">Special Contract Terms</h3>
                                    <span class="workflow-step-readonly--blue-text">
                                        {{item?.value?.consultantSpecialContractTerms ? item?.value?.consultantSpecialContractTerms : '-'}}
                                    </span>
                                </div>
                            </div>
                            <ng-container *ngIf="(item.value?.consultantProdataEntity?.id && salesClientDataForm.value?.pdcInvoicingEntityId?.id) && (item.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-step-readonly--header u-mb--20">Account manager</h2>
                                    <div fxLayout="column" class="u-w--100 u-mb--20">
                                        <h3 class="workflow-step-readonly--gray-header">Delivery Account Manager</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            <ng-container *ngIf="item?.value?.deliveryManagerSameAsAccountManager; else deliveryAccountManagerDisplay">
                                                Same as account manager
                                            </ng-container>
                                            <ng-template #deliveryAccountManagerDisplay>
                                                {{item?.value?.deliveryAccountManager ? item?.value?.deliveryAccountManager?.name : '-'}}
                                            </ng-template>
                                        </span>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                        <mat-divider></mat-divider>
                    </ng-container>
                </ng-container>
            </form>
        </ng-container>
    </ng-container>
    <ng-template #editMode>
        <ng-container *ngIf="(activeSideSection.typeId !== workflowSideSections.TerminateWorkflow) && (activeSideSection.typeId !== workflowSideSections.TerminateConsultant); else terminationTemplate">
            <form [formGroup]="salesMainDataForm" id="mainData" class="workflow-form workflow-form--main u-w--100">
                <ng-container *ngIf="(activeSideSection.typeId === workflowSideSections.StartConsultantPeriod) || (activeSideSection.typeId === workflowSideSections.ChangeConsultantPeriod) || (activeSideSection.typeId === workflowSideSections.ExtendConsultantPeriod); else startClientPeriodTemplate">
                    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100" id="salesMainDataAnchor">
                        <h1 class="workflow-section--header-main">Main data</h1>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10  u-mt--10">
                            <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                <mat-label>Remarks</mat-label>
                                <textarea matInput autocomplete="new-password" name="remarks" formControlName="remarks" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                </textarea>
                            </mat-form-field>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                            <mat-checkbox color="accent" formControlName="noRemarks" name="noRemarks" class="black-checkbox" (change)="disableOrEnableInput(salesMainDataForm?.noRemarks?.value, salesMainDataForm?.remarks)">
                                None
                            </mat-checkbox>
                        </div>
                    </div>
                </ng-container>
                <ng-template #startClientPeriodTemplate>
                    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100" id="salesMainDataAnchor">
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h1 class="workflow-section--header-main">Main data</h1>
                            <h2 class="workflow-section--header">Project</h2>
                            <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod">
                                <h3 class="workflow-gray--header">Project Type (Legacy)</h3>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10 u-mt--10">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%">
                                        <mat-label>Project type</mat-label>
                                        <mat-select formControlName="projectType" [disableOptionCentering]="false" [compareWith]="compareWithFn" (selectionChange)="getDataBasedOnProjectType($event)">
                                            <mat-option *ngFor="let item of projectTypes" [value]="item">
                                                {{ item.name }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>

                                <h3 class="workflow-gray--header">Sales Type</h3>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <mat-button-toggle-group class="workflow-toggle-buttons u-mt--10" formControlName="salesType" (change)="salesTypeChange($event.value)">
                                        <mat-button-toggle [value]="item" *ngFor="let item of saleTypes">
                                            {{ item.name }}
                                        </mat-button-toggle>
                                    </mat-button-toggle-group>
                                </div>

                                <h3 class="workflow-gray--header">Delivery Type</h3>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <mat-button-toggle-group class="workflow-toggle-buttons u-mt--10" formControlName="deliveryType">
                                        <mat-button-toggle
                                            [value]="item"
                                            *ngFor="let item of deliveryTypes"
                                            [ngClass]="{'hide':
                                                    item.id === 1 && salesMainDataForm?.salesType?.value?.id !== 3 ||
                                                    item.id !== 1 && salesMainDataForm?.salesType?.value?.id === 3
                                            }">
                                            <!-- // salesTpye id 3 = Managed Service -->
                                            <!-- // deliveryTpye id 1 = Managed Service -->
                                            {{ item.name }}
                                        </mat-button-toggle>
                                    </mat-button-toggle-group>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                        <mat-label>Margin</mat-label>
                                        <mat-select formControlName="margin" [disableOptionCentering]="true" [compareWith]="compareWithFn" required>
                                            <mat-option class="mat-select-clear-option">
                                                Clear
                                            </mat-option>
                                            <mat-option *ngFor="let item of margins" [value]="item">
                                                {{ item.name }}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error>{{getValidationMessage(salesMainDataForm.margin)}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                        <mat-label>Project Category</mat-label>
                                        <mat-select formControlName="projectCategory" [disableOptionCentering]="false" [compareWith]="compareWithFn">
                                            <mat-option *ngFor="let item of projectCategories" [value]="item">
                                                {{ item.name }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.ExtendClientPeriod || activeSideSection.typeId === workflowSideSections.ChangeClientPeriod">
                                <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="120px" class="u-w--100 u-mb--20">
                                    <div fxLayout="column">
                                        <h3 class="workflow-step-readonly--gray-header">Project Type (Legacy)</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesMainDataForm?.projectType?.value?.name}}
                                        </span>
                                    </div>
                                    <div fxLayout="column">
                                        <h3 class="workflow-step-readonly--gray-header">Sales Type</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesMainDataForm?.salesType?.value?.name}}
                                        </span>
                                    </div>
                                    <div fxLayout="column">
                                        <h3 class="workflow-step-readonly--gray-header">Delivery Type</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesMainDataForm?.deliveryType?.value?.name}}
                                        </span>
                                    </div>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                        <mat-label>Margin</mat-label>
                                        <mat-select formControlName="margin" [disableOptionCentering]="true" [compareWith]="compareWithFn" required>
                                            <mat-option class="mat-select-clear-option">
                                                Clear
                                            </mat-option>
                                            <mat-option *ngFor="let item of margins" [value]="item">
                                                {{ item.name }}
                                            </mat-option>
                                        </mat-select>
                                        <mat-error>{{getValidationMessage(salesMainDataForm.margin)}}</mat-error>
                                    </mat-form-field>
                                </div>
                                <div fxLayout="column" class="u-w--100 u-mb--20">
                                    <h3 class="workflow-step-readonly--gray-header">Project Category</h3>
                                    <span class="workflow-step-readonly--blue-text-bold">
                                        {{salesMainDataForm?.projectCategory?.value?.name ?? '-'}}
                                    </span>
                                </div>
                            </ng-container>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                    <mat-label>Project Description</mat-label>
                                    <textarea matInput autocomplete="new-password" name="projectDescription" formControlName="projectDescription" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                    </textarea>
                                    <mat-error>{{getValidationMessage(salesMainDataForm.projectDescription)}}</mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Invoicing</h2>
                            <h3 class="workflow-gray--header">Discounts</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-button-toggle-group class="workflow-toggle-buttons u-mt--10" formControlName="discounts">
                                    <mat-button-toggle [value]="item" *ngFor="let item of discounts">
                                        {{ item.name }}
                                    </mat-button-toggle>
                                </mat-button-toggle-group>
                            </div>

                            <h3 class="workflow-gray--header">Commission</h3>

                                <div class="inline-edit-form u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesMainDataForm.commissions?.controls?.length">
                                        <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                            Type
                                        </span>
                                        <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                            Value
                                        </span>
                                        <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                            Currency
                                        </span>
                                        <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                            Recipient type
                                        </span>
                                        <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                            Recipient
                                        </span>
                                        <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                            Frequency
                                        </span>
                                        <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">

                                        </span>
                                    </div>
                                    <ng-container formArrayName="commissions" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                            *ngFor="let commission of salesMainDataForm.commissions.controls; index as i"
                                            [formArrayName]="i">
                                            <ng-container *ngIf="salesMainDataForm.commissions.at(i).get('editable')?.value">
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="10%">
                                                    <mat-select formControlName="type" placeholder="Type" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of commissionTypes" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="10%">
                                                    <input matInput type="text" formControlName="amount" placeholder="Value" />
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="10%">
                                                    <mat-select formControlName="currency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="10%">
                                                    <mat-select formControlName="recipientType" placeholder="Recipient type" [disableOptionCentering]="true" (selectionChange)="commissionRecipientTypeChanged($event, i)" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of commissionRecipientTypeList" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="30%" [ngClass]="{'disabled-autocomplete': commission.value.recipientType === null || commission.value.recipientType === ''}">
                                                    <!-- recipientType?.id === 4 - PDC entity -->
                                                    <ng-container *ngIf="commission.value.recipientType?.id === 4; else commissionRecipientAutocomplete">
                                                        <mat-select formControlName="recipient" placeholder="Recipient" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of tenants" [value]="item">
                                                                <b>{{ item.name }}</b>
                                                            </mat-option>
                                                        </mat-select>
                                                    </ng-container>
                                                    <ng-template #commissionRecipientAutocomplete>
                                                        <input #recipientFilterInput type="text" matInput [matAutocomplete]="recipientAutocomplete" formControlName="recipient" (click)="$event.stopPropagation()" placeholder="Recipient">
                                                        <mat-autocomplete #recipientAutocomplete="matAutocomplete" [displayWith]="displayRecipientFn">
                                                            <ng-container>
                                                                <mat-option *ngFor="let recipient of filteredRecipients" [value]="recipient" [ngClass]="{ 'no-data': recipient.id === 'no-data' }">
                                                                    <ng-container [ngSwitch]="commission.value.recipientType?.id">
                                                                        <!-- 'Client' -->
                                                                        <span *ngSwitchCase="3">
                                                                            <div class="multilineDropdown-option--column">
                                                                                <b>{{ recipient.clientName }}</b>
                                                                                <span *ngIf="recipient.id !== 'no-data'"> #{{recipient.clientId}} | {{recipient.address}} | {{recipient.address2}} | {{recipient.postCode}}</span>
                                                                            </div>
                                                                        </span>
                                                                        <!-- 'Supplier' -->
                                                                        <span *ngSwitchCase="1">
                                                                            <b>{{ recipient.supplierName }}</b>
                                                                        </span>
                                                                        <!-- 'Consultant' -->
                                                                        <span *ngSwitchCase="2">
                                                                            <div class="multilineDropdown-option--row">
                                                                                <img *ngIf="recipient.id !== 'no-data'" class="image-settings--dropdown u-ml--16 u-mr--16" [src]="consultantProfileUrl(recipient.externalId!)" />
                                                                                <div class="multilineDropdown-option--column">
                                                                                    <b>{{ recipient.name }}</b>
                                                                                    <span *ngIf="recipient.id !== 'no-data'"> | {{recipient.companyName}} | {{recipient.city}} | #{{recipient.id}} / {{recipient.legacyId}}</span>
                                                                                </div>
                                                                            </div>
                                                                        </span>
                                                                    </ng-container>
                                                                </mat-option>
                                                            </ng-container>
                                                        </mat-autocomplete>
                                                    </ng-template>
                                                </mat-form-field>
                                                <div fxFlex="20%">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="1 0 40%">
                                                        <mat-select formControlName="frequency" placeholder="Frequency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of commissionFrequencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                    <!--id = 2 == 'One time' -->
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select formFieldDatePicker" fxFlex="0 0 60%" *ngIf="commission.value.frequency?.id === 2">
                                                        <input autocomplete="off" matInput
                                                                [matDatepicker]="oneTimeDatePicker"
                                                                placeholder="Date"
                                                                name="oneTimeDate" formControlName="oneTimeDate"
                                                                (focus)="oneTimeDatePicker.open()"
                                                                (click)="oneTimeDatePicker.open()" readonly>
                                                        <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                                        <mat-datepicker #oneTimeDatePicker></mat-datepicker>
                                                    </mat-form-field>
                                                </div>
                                                <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                                    <button mat-flat-button type="button" (click)="editOrSaveCommissionRow(i)" class="inline-edit-form--btn__save">
                                                        Save
                                                    </button>
                                                    <button mat-flat-button type="button" (click)="isCommissionInitialAdd ? removeCommission(i) : cancelEditCommissionRow(i)" class="inline-edit-form--btn__cancel">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </ng-container>
                                            <ng-container *ngIf="!commission.value.editable">
                                                <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('type')?.value?.name" matTooltipClass="white-tooltip">
                                                    {{commission.value.type?.name}}
                                                </span>
                                                <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('amount')?.value" matTooltipClass="white-tooltip">
                                                    {{commission.value.amount}}
                                                </span>
                                                <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('currency')?.value?.name" matTooltipClass="white-tooltip">
                                                    {{commission.value.currency?.name}}
                                                </span>
                                                <span fxFlex="10%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('recipientType')?.value?.name" matTooltipClass="white-tooltip">
                                                    {{commission.value.recipientType?.name}}
                                                </span>
                                                <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('recipient')?.value?.name" matTooltipClass="white-tooltip">
                                                    <ng-container [ngSwitch]="commission.value.recipientType?.name">
                                                        <ng-container *ngSwitchCase="'Client'">
                                                            <div fxLayout="row" fxLayoutAlign="start center">
                                                                <div fxLayout="column" fxLayoutAlign="start start">
                                                                    <span>
                                                                        {{commission.value.recipient?.clientName}}
                                                                    </span>
                                                                    <span>
                                                                        {{commission.value.recipient?.clientId ? '#' + commission.value.recipient?.clientId + ' | ' : ''}}
                                                                        {{commission.value.recipient?.city ? commission.value.recipient?.city + ' | ' : ''}}
                                                                        {{commission.value.recipient?.address ? commission.value.recipient?.address + ' | ' : ''}}
                                                                        {{commission.value.recipient?.address2 ? commission.value.recipient?.address2 + ' | ' : ''}}
                                                                        {{commission.value.recipient?.postCode}}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="'Consultant'">
                                                            <div fxLayout="row" fxLayoutAlign="start center">
                                                                <div fxLayout="column" fxLayoutAlign="start start">
                                                                    <span>
                                                                        {{commission.value.recipient?.name}}
                                                                    </span>
                                                                    <span>
                                                                        {{commission.value.recipient?.companyName ? commission.value.recipient?.companyName + ' | ' : ''}}
                                                                        {{commission.value.recipient?.city ? commission.value.recipient?.city + ' | ' : ''}}
                                                                        #{{commission.value.recipient?.id}} / {{getTenantCodeFromId(commission.value.recipient?.tenantId) + '-' +commission.value.recipient?.legacyId}}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="'Supplier'">
                                                            {{commission.value.recipient?.supplierName}}
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="'PDC entity'">
                                                            {{commission.value.recipient?.name}}
                                                        </ng-container>
                                                    </ng-container>
                                                </span>
                                                <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="salesMainDataForm.commissions.at(i).get('frequency')?.value?.name" matTooltipClass="white-tooltip">
                                                    <!-- frequency id === 2 -- 'One time' -->
                                                    <ng-container *ngIf="salesMainDataForm.commissions.at(i).get('frequency')?.value?.id === 2; else commissionFrequency">
                                                        {{salesMainDataForm.commissions.at(i).get('frequency')?.value?.name}} {{salesMainDataForm.commissions.at(i).get('oneTimeDate')?.value | momentFormat: 'DD.MM.YYYY'}}
                                                    </ng-container>
                                                    <ng-template #commissionFrequency>
                                                        {{salesMainDataForm.commissions.at(i).get('frequency')?.value?.name}}
                                                    </ng-template>
                                                </span>
                                                <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100">
                                                    <button mat-icon-button type="button" (click)="$event.stopPropagation();" [matMenuTriggerFor]="commissionMenu" class="three-dots-actions-btn">
                                                        <mat-icon>more_horiz</mat-icon>
                                                    </button>
                                                    <mat-menu #commissionMenu>
                                                        <button
                                                            class="menu-item"
                                                            [ngClass]="salesMainDataForm.commissions.at(i).get('editable')?.value ? 'menu-item--add': 'menu-item--edit'"
                                                            mat-menu-item
                                                            [disabled]="isCommissionEditing"
                                                            (click)="editOrSaveCommissionRow(i)">
                                                            <mat-icon>{{salesMainDataForm.commissions.at(i).get('editable')?.value ? 'save' : 'create'}}</mat-icon>
                                                            {{salesMainDataForm.commissions.at(i).get('editable')?.value ? 'Save' : 'Edit'}}
                                                        </button>
                                                        <button
                                                            class="menu-item menu-item--cancel"
                                                            mat-menu-item
                                                            (click)="removeCommission(i)">
                                                            <mat-icon>clear</mat-icon>
                                                            Remove
                                                        </button>
                                                    </mat-menu>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </ng-container>

                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <button color="primary" class="u-mt--10 button-outlined" mat-flat-button type="button" [disabled]="isCommissionEditing" (click)="addCommission(true)">Add commission</button>
                                    </div>
                                </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                            <h2 class="workflow-section--header">Account manager</h2>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                    <mat-label>Sales Account Manager</mat-label>
                                    <input #salesAccountManagerFilterInput type="text" matInput [matAutocomplete]="salesManagerAutocomplete" formControlName="salesAccountManagerIdValue" (click)="$event.stopPropagation()" placeholder="Select account manager(s)">
                                </mat-form-field>
                                <mat-autocomplete #salesManagerAutocomplete="matAutocomplete" [displayWith]="displayNameFn">
                                    <ng-container>
                                        <mat-option *ngFor="let manager of filteredSalesAccountManagers"
                                            [value]="manager"
                                            [ngClass]="{ 'no-data': manager.id === 'no-data' }">
                                            <span>{{ manager.name }}</span>
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>

                                <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%">
                                    <mat-label>Commission Account Manager</mat-label>
                                    <input #commissionManagerFilterInput type="text" matInput [matAutocomplete]="commissionManagerAutocomplete" formControlName="commissionAccountManagerIdValue" (click)="$event.stopPropagation()" placeholder="Select account manager(s)">
                                </mat-form-field>
                                <mat-autocomplete #commissionManagerAutocomplete="matAutocomplete" [displayWith]="displayNameFn">
                                    <ng-container>
                                        <mat-option *ngFor="let manager of filteredCommisionAccountManagers"
                                            [value]="manager"
                                            [ngClass]="{ 'no-data': manager.id === 'no-data' }">
                                            <span>{{ manager.name }}</span>
                                        </mat-option>
                                    </ng-container>
                                </mat-autocomplete>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                    <mat-label>Contract expiration notification</mat-label>
                                    <mat-select formControlName="contractExpirationNotification" [disableOptionCentering]="true" [multiple]="true">
                                        <mat-option [value]="999">
                                            Manual date
                                        </mat-option>
                                        <mat-option [value]="+item.key" *ngFor="let item of contractExpirationNotificationDuration | keyvalue">
                                            {{ item.value }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field appearance="outline" fxFlex="33%" *ngIf="salesMainDataForm.contractExpirationNotification?.value?.includes(999)">
                                    <mat-label>Contract expiration notification date</mat-label>
                                    <input autocomplete="off" matInput
                                            [matDatepicker]="customContractExpirationNotificationDatePicker"
                                            name="customContractExpirationNotificationDate" formControlName="customContractExpirationNotificationDate"
                                            (focus)="customContractExpirationNotificationDatePicker.open()"
                                            (click)="customContractExpirationNotificationDatePicker.open()" readonly>
                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                    <mat-datepicker #customContractExpirationNotificationDatePicker></mat-datepicker>
                                </mat-form-field>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                    <mat-label>Remarks</mat-label>
                                    <textarea matInput autocomplete="new-password" name="remarks" formControlName="remarks" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                    </textarea>
                                </mat-form-field>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                                <mat-checkbox color="accent" formControlName="noRemarks" name="noRemarks" class="black-checkbox" (change)="disableOrEnableInput(salesMainDataForm?.noRemarks?.value, salesMainDataForm?.remarks)">
                                    None
                                </mat-checkbox>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </form>
            <ng-container *ngIf="(activeSideSection.typeId !== workflowSideSections.StartConsultantPeriod) && (activeSideSection.typeId !== workflowSideSections.ChangeConsultantPeriod) && (activeSideSection.typeId !== workflowSideSections.ExtendConsultantPeriod)">
                <form [formGroup]="salesClientDataForm" id="clientData" class="workflow-form workflow-form--client u-w--100" id="salesClientDataAnchor">
                    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100">
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h1 class="workflow-section--header-main">Client data</h1>
                            <h2 class="workflow-section--header">Client</h2>
                            <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod">
                                <h3 class="workflow-gray--header u-mb--10">Client relation</h3>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                    <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="differentEndClient">
                                        <mat-button-toggle [value]="item.value" *ngFor="let item of [{name: 'Direct Client', value: false}, {name: 'Different end-client', value: true}]">
                                            {{ item.name }}
                                        </mat-button-toggle>
                                    </mat-button-toggle-group>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                    <mat-form-field appearance="outline" class="u-w--100 filter-select" fxFlex="33%">
                                        <mat-label>Direct client</mat-label>
                                        <input #directClientFilterInput type="text" matInput [matAutocomplete]="directClientAutocomplete" formControlName="directClientIdValue" (click)="$event.stopPropagation()" placeholder="Direct client name + address">
                                        <mat-autocomplete #directClientAutocomplete="matAutocomplete" [displayWith]="displayClientNameFn" (optionSelected)="directClientSelected($event)">
                                            <ng-container>
                                                <mat-option *ngFor="let client of filteredDirectClients" [value]="client" [ngClass]="{ 'no-data': client.id === 'no-data' }">
                                                    <div class="multilineDropdown-option--column">
                                                        <b>{{ client.clientName }}</b>
                                                        <span *ngIf="client.id !== 'no-data'"> #{{client.clientId}} | {{client.address}} | {{client.address2}} | {{client.postCode}}</span>
                                                    </div>
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngIf="salesClientDataForm?.differentEndClient?.value">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%">
                                        <mat-label>End client</mat-label>
                                        <input #endClientFilterInput type="text" matInput [matAutocomplete]="endClientAutocomplete" formControlName="endClientIdValue" (click)="$event.stopPropagation()" placeholder="End client name + address">
                                    </mat-form-field>
                                    <mat-autocomplete #endClientAutocomplete="matAutocomplete" [displayWith]="displayClientNameFn">
                                        <ng-container>
                                            <mat-option *ngFor="let client of filteredEndClients" [value]="client" [ngClass]="{ 'no-data': client.id === 'no-data' }">
                                                <div class="multilineDropdown-option--column">
                                                    <b>{{ client.clientName }}</b>
                                                    <span *ngIf="client.id !== 'no-data'">#{{client.clientId}} | {{client.address}} | {{client.address2}} | {{client.postCode}}</span>
                                                </div>
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </div>
                            </ng-container>

                            <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.ExtendClientPeriod || activeSideSection.typeId === workflowSideSections.ChangeClientPeriod">
                                <div fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="20px" class="u-w--100 u-mb--20" fxFlex="80%">
                                    <div fxLayout="column">
                                        <h3 class="workflow-step-readonly--gray-header">Client relation</h3>
                                        <span class="workflow-step-readonly--blue-text-bold">
                                            {{salesClientDataForm?.differentEndClient?.value ? 'Different end-client' : 'Direct Client'}}
                                        </span>
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <div fxLayout="column" fxFlex="50%">
                                            <h3 class="workflow-step-readonly--gray-header">Direct client</h3>
                                            <div fxLayout="row" fxLayoutAlign="start center" *ngIf="salesClientDataForm?.directClientIdValue?.value; else noDataTemplate">
                                                <div fxLayout="column" fxLayoutAlign="start start">
                                                    <span class="workflow-step-readonly--blue-text-bold">
                                                        {{salesClientDataForm?.directClientIdValue?.value?.clientName}}
                                                    </span>
                                                    <span class="workflow-step-readonly--blue-text-bold">
                                                        {{salesClientDataForm?.directClientIdValue?.value?.clientId ? '#' + salesClientDataForm?.directClientIdValue?.value?.clientId + ' | ' : '' }}
                                                        {{salesClientDataForm?.directClientIdValue?.value?.city ? salesClientDataForm?.directClientIdValue?.value?.city + ' | ' : ''}}
                                                        {{salesClientDataForm?.directClientIdValue?.value?.address ? salesClientDataForm?.directClientIdValue?.value?.address + ' | ' : ''}}
                                                        {{salesClientDataForm?.directClientIdValue?.value?.address2 ? salesClientDataForm?.directClientIdValue?.value?.address2 + ' | ' : ''}}
                                                        {{salesClientDataForm?.directClientIdValue?.value?.postCode}}
                                                    </span>
                                                </div>
                                            </div>
                                            <ng-template #noDataTemplate>
                                                <span class="workflow-step-readonly--blue-text-bold">
                                                    -
                                                </span>
                                            </ng-template>
                                        </div>
                                        <div fxLayout="column" fxFlex="50%" *ngIf="salesClientDataForm?.endClientIdValue?.value">
                                            <h3 class="workflow-step-readonly--gray-header">End client</h3>
                                            <div fxLayout="row" fxLayoutAlign="start center">
                                                <div fxLayout="column" fxLayoutAlign="start start">
                                                    <span class="workflow-step-readonly--blue-text-bold">
                                                        {{salesClientDataForm?.endClientIdValue?.value?.clientName}}
                                                    </span>
                                                    <span class="workflow-step-readonly--blue-text-bold">
                                                        {{salesClientDataForm?.endClientIdValue?.value?.clientId ? '#' + salesClientDataForm?.endClientIdValue?.value?.clientId + ' | ' : '' }}
                                                        {{salesClientDataForm?.endClientIdValue?.value?.city ? salesClientDataForm?.endClientIdValue?.value?.city + ' | ' : ''}}
                                                        {{salesClientDataForm?.endClientIdValue?.value?.address ? salesClientDataForm?.endClientIdValue?.value?.address + ' | ' : ''}}
                                                        {{salesClientDataForm?.endClientIdValue?.value?.address2 ? salesClientDataForm?.endClientIdValue?.value?.address2 + ' | ' : ''}}
                                                        {{salesClientDataForm?.endClientIdValue?.value?.postCode}}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Duration</h2>
                            <h3 class="workflow-gray--header u-mb--10">Project duration</h3>
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label>Start date</mat-label>
                                    <input autocomplete="off" matInput
                                            [matDatepicker]="clientContractStartDatePicker"
                                            name="clientContractStartDate" formControlName="clientContractStartDate"
                                            (focus)="clientContractStartDatePicker.open()"
                                            (click)="clientContractStartDatePicker.open()" readonly>
                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                    <mat-datepicker #clientContractStartDatePicker></mat-datepicker>
                                </mat-form-field>
                                <mat-form-field appearance="outline" class="u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label>End date</mat-label>
                                    <input autocomplete="off" matInput
                                            [matDatepicker]="clientContractEndDatePicker"
                                            name="clientContractEndDate" formControlName="clientContractEndDate"
                                            (focus)="clientContractEndDatePicker.open()"
                                            (click)="clientContractEndDatePicker.open()" readonly>
                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                    <mat-datepicker #clientContractEndDatePicker></mat-datepicker>
                                </mat-form-field>
                                <mat-checkbox color="accent" formControlName="clientContractNoEndDate" name="clientContractNoEndDate" class="black-checkbox" (change)="disableOrEnableInput(salesClientDataForm?.clientContractNoEndDate?.value, salesClientDataForm?.clientContractEndDate)">
                                    No end date
                                </mat-checkbox>
                            </div>

                            <h3 class="workflow-gray--header u-mb--10">Option to extend</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="noClientExtensionOption">
                                    <mat-button-toggle [value]="false">
                                        Option to extend
                                    </mat-button-toggle>
                                    <mat-button-toggle [value]="true">
                                        No option
                                    </mat-button-toggle>
                                </mat-button-toggle-group>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="!salesClientDataForm?.noClientExtensionOption?.value">
                                <mat-form-field appearance="outline" class="filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label> Duration</mat-label>
                                    <mat-select formControlName="clientExtensionDuration" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                        <mat-option *ngFor="let item of clientExtensionDurations" [value]="item">
                                            {{ item.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline" class="filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label> Deadline</mat-label>
                                    <mat-select formControlName="clientExtensionDeadline" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                        <mat-option *ngFor="let item of clientExtensionDeadlines" [value]="item">
                                            {{ item.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <mat-form-field appearance="outline" *ngIf="salesClientDataForm?.clientExtensionDeadline?.value?.name === 'Manual date'" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label>Specific date</mat-label>
                                    <input autocomplete="off" matInput
                                            [matDatepicker]="clientExtensionEndDatePicker"
                                            name="clientExtensionEndDate" formControlName="clientExtensionEndDate"
                                            (focus)="clientExtensionEndDatePicker.open()"
                                            (click)="clientExtensionEndDatePicker.open()" readonly>
                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                    <mat-datepicker #clientExtensionEndDatePicker></mat-datepicker>
                                </mat-form-field>
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Invoicing</h2>
                            <h3 class="workflow-gray--header u-mb--10">Invoicing Entity</h3>
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%">
                                    <mat-label>ProData entity</mat-label>
                                    <mat-select formControlName="pdcInvoicingEntityId" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                        <mat-option *ngFor="let item of tenants" [value]="item">
                                            {{ item.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>

                            <h3 class="workflow-gray--header u-mb--10">Price</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="clientRateAndInvoicing" (change)="clientRateTypeChange($event.value)">
                                    <mat-button-toggle [value]="item" *ngFor="let item of clientRateTypes">
                                        {{ item.name }}
                                    </mat-button-toggle>
                                </mat-button-toggle-group>
                            </div>
                            <div class="u-w--100" [ngSwitch]="salesClientDataForm.clientRateAndInvoicing?.value?.id">
                                <ng-container *ngSwitchCase="1"> <!-- 'Time based' -->
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                        <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Price</mat-label>
                                            <input autocomplete="off" matInput formControlName="clientPrice" type="text">
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Unit type</mat-label>
                                            <mat-select formControlName="rateUnitTypeId" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of rateUnitTypes" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Currency</mat-label>
                                            <mat-select formControlName="clientCurrency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of currencies" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </ng-container>
                                <ng-container *ngSwitchCase="2"> <!-- 'Fixed' -->
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                        <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Price</mat-label>
                                            <input autocomplete="off" matInput formControlName="clientPrice" type="text">
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Currency</mat-label>
                                            <mat-select formControlName="clientCurrency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of currencies" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                </ng-container>
                            </div>

                            <h3 class="workflow-gray--header u-mb--10">Invoicing information</h3>
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label>Invoicing currency</mat-label>
                                    <mat-select formControlName="clientInvoiceCurrency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                            {{ item.name }}
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>

                                <ng-container [ngSwitch]="salesClientDataForm.clientRateAndInvoicing?.value?.id">
                                    <ng-container *ngSwitchCase="1"> <!-- Time based -->
                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%" [ngClass]="{'u-mr--16': salesClientDataForm.clientInvoiceFrequency?.value?.name === 'Manual date'}">
                                            <mat-label>Invoicing frequency</mat-label>
                                            <mat-select formControlName="clientInvoiceFrequency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of invoiceFrequencies" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <!-- FIXME: - manual date now is gone? -->
                                        <mat-form-field *ngIf="salesClientDataForm.clientInvoiceFrequency?.value?.id === 'Manual date'" appearance="outline" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Date</mat-label>
                                            <input autocomplete="off" matInput
                                                    [matDatepicker]="clientInvoicingDateDatePicker"
                                                    name="clientInvoicingDate" formControlName="clientInvoicingDate"
                                                    (focus)="clientInvoicingDateDatePicker.open()"
                                                    (click)="clientInvoicingDateDatePicker.open()" readonly>
                                            <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                            <mat-datepicker #clientInvoicingDateDatePicker></mat-datepicker>
                                        </mat-form-field>
                                    </ng-container>
                                    <ng-container *ngSwitchCase="2"> <!-- Fixed -->
                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%" [ngClass]="{'u-mr--16': salesClientDataForm.clientInvoiceTime?.value?.name === 'Manual date'}">
                                            <mat-label>Invoicing time</mat-label>
                                            <mat-select formControlName="clientInvoiceTime" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of invoicingTimes" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <!-- id: 2 - manual date -->
                                        <mat-form-field *ngIf="salesClientDataForm.clientInvoiceTime?.value?.id === 2" appearance="outline" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Date</mat-label>
                                            <input autocomplete="off" matInput
                                                    [matDatepicker]="clientInvoicingDateDatePicker"
                                                    name="clientInvoicingDate" formControlName="clientInvoicingDate"
                                                    (focus)="clientInvoicingDateDatePicker.open()"
                                                    (click)="clientInvoicingDateDatePicker.open()" readonly>
                                            <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                            <mat-datepicker #clientInvoicingDateDatePicker></mat-datepicker>
                                        </mat-form-field>
                                    </ng-container>
                                </ng-container>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100 " fxFlex="33%">
                                    <mat-label>Invoicing Reference Number</mat-label>
                                    <input autocomplete="off" matInput formControlName="invoicingReferenceNumber" type="text">
                                </mat-form-field>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100 filter-select u-mr--16" fxFlex="33%">
                                    <mat-label>Client invoicing recipient</mat-label>
                                    <input #clientInvoicingRecipientInput type="text" matInput [matAutocomplete]="clientInvoicingRecipientAutocomplete" formControlName="clientInvoicingRecipientIdValue" (click)="$event.stopPropagation()" placeholder="Client invoicing recipient">
                                    <mat-autocomplete #clientInvoicingRecipientAutocomplete="matAutocomplete" [displayWith]="displayClientNameFn">
                                        <ng-container>
                                            <mat-option *ngFor="let client of filteredClientInvoicingRecipients" [value]="client" [ngClass]="{ 'no-data': client.id === 'no-data' }">
                                                <div class="multilineDropdown-option--column">
                                                    <b>{{ client.clientName }}</b>
                                                    <span *ngIf="client.id !== 'no-data'">#{{client.clientId}} | {{client.address}} | {{client.address2}} | {{client.postCode}}</span>
                                                </div>
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                                <!-- <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10"> -->
                                <mat-checkbox color="accent" formControlName="clientInvoicingRecipientSameAsDirectClient" name="clientInvoicingRecipientSameAsDirectClient" class="black-checkbox u-mr--10" (change)="disableOrEnableInput(salesClientDataForm?.clientInvoicingRecipientSameAsDirectClient?.value, salesClientDataForm?.clientInvoicingRecipientIdValue)">
                                    Same as direct client
                                </mat-checkbox>
                                <!-- </div> -->
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100 filter-select u-mr--16" fxFlex="33%">
                                    <mat-label>Invoicing Reference Person</mat-label>
                                    <input #invoicingReferencePersonInput type="text" matInput [matAutocomplete]="invoicingReferencePersonAutocomplete" formControlName="invoicingReferencePersonIdValue" (click)="$event.stopPropagation()" placeholder="Invoicing Reference Person">
                                    <mat-autocomplete #invoicingReferencePersonAutocomplete="matAutocomplete" [displayWith]="displayFullNameFn">
                                        <ng-container>
                                            <mat-option *ngFor="let contact of filteredReferencePersons" [value]="contact" [ngClass]="{ 'no-data': contact.id === 'no-data' }">
                                                    <b>{{ contact.firstName + ' ' + contact.lastName }}</b>
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>
                                <!-- <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10"> -->
                                    <mat-checkbox color="accent" formControlName="noInvoicingReferencePerson" name="noInvoicingReferencePerson" class="black-checkbox u-mr--10" (change)="disableOrEnableInput(salesClientDataForm?.noInvoicingReferencePerson?.value, salesClientDataForm?.invoicingReferencePersonIdValue)">
                                        None
                                    </mat-checkbox>
                                <!-- </div> -->
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Project</h2>
                            <h3 class="workflow-gray--header u-mb--10">Shared Cap on Time Reporting</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="capOnTimeReporting">
                                    <mat-button-toggle *ngFor="let item of clientTimeReportingCap" [value]="item">
                                        {{ item.name }}
                                    </mat-button-toggle>
                                </mat-button-toggle-group>
                            </div>
                            <!--not visible if 'Individual cap' Id = 3 'No cap' id = 4 -->
                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="salesClientDataForm.capOnTimeReporting?.value?.id !== 3 && salesClientDataForm.capOnTimeReporting?.value?.id !== 4">
                                <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                    <mat-label>Max value</mat-label>
                                    <input autocomplete="off" matInput formControlName="capOnTimeReportingValue" type="text">
                                </mat-form-field>
                                <span class="workflow-step-readonly--blue-text-bold">
                                    <ng-container [ngSwitch]="salesClientDataForm?.capOnTimeReporting?.value?.id">
                                        <ng-container *ngSwitchCase="1"> <!-- Cap on units -->
                                            <ng-container [ngSwitch]="salesClientDataForm?.rateUnitTypeId?.value?.id">
                                                <ng-container *ngSwitchCase="1"> <!-- Per hour -->
                                                    hours
                                                </ng-container>
                                                <ng-container *ngSwitchCase="2"> <!-- Per day -->
                                                    days
                                                </ng-container>
                                                <ng-container *ngSwitchCase="3"> <!-- Per month -->
                                                    months
                                                </ng-container>
                                            </ng-container>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="2"> <!-- Cap on value -->
                                            {{salesClientDataForm?.clientCurrency?.value?.name ? salesClientDataForm?.clientCurrency?.value?.name : '-'}}
                                        </ng-container>
                                    </ng-container>
                                </span>
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Rates and fees</h2>

                            <div class="inline-edit-form u-w--100">
                                <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesClientDataForm.clientRates?.controls?.length">
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Rate name
                                    </span>
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Reporting unit
                                    </span>
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Client rate
                                    </span>
                                    <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                    </span>
                                </div>
                                <ng-container formArrayName="clientRates" class="u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                        *ngFor="let rate of salesClientDataForm.clientRates.controls; index as i"
                                        [formArrayName]="i">
                                        <ng-container>
                                            <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.rateName" matTooltipClass="white-tooltip">
                                                {{rate.value.rateName ?? '-'}}
                                            </span>
                                            <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.reportingUnit?.name" matTooltipClass="white-tooltip">
                                                {{rate.value.reportingUnit?.name ?? '-'}}
                                            </span>

                                            <ng-container *ngIf="rate.value.editable; else clientRateCurrencyDisplay">
                                                <div fxFlex="30%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="number" placeholder="Rate" formControlName="clientRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="clientRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                            </ng-container>
                                            <ng-template #clientRateCurrencyDisplay>
                                                <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.clientRateValue + ' ' + rate.value.clientRateCurrency?.name" matTooltipClass="white-tooltip">
                                                    {{rate.value.clientRateValue || rate.value.clientRateCurrency?.name ? rate.value.clientRateValue + ' ' + rate.value.clientRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-template>
                                            <ng-container *ngIf="rate.value.editable; else clientRateActionDisplay">
                                                <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis" fxLayoutAlign="end center">
                                                    <button mat-flat-button type="button" (click)="editOrSaveSpecialRate(rate.value.editable, i)" class="inline-edit-form--btn__save">
                                                        Save
                                                    </button>
                                                    <button mat-flat-button type="button" (click)="cancelEditClientRate(i)" class="inline-edit-form--btn__cancel">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </ng-container>
                                            <ng-template #clientRateActionDisplay>
                                                <div fxFlex="10%" fxLayoutAlign="end center" class="u-w--100">
                                                    <button mat-icon-button type="button" (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientRateMenu" class="three-dots-actions-btn">
                                                        <mat-icon>more_horiz</mat-icon>
                                                    </button>
                                                    <mat-menu #clientRateMenu>
                                                        <button
                                                            class="menu-item"
                                                            [ngClass]="salesClientDataForm.clientRates.at(i).get('editable')?.value ? 'menu-item--add': 'menu-item--edit'"
                                                            mat-menu-item
                                                            [disabled]="isClientRateEditing"
                                                            (click)="editOrSaveSpecialRate(rate.value.editable, i)">
                                                            <mat-icon>create</mat-icon>
                                                            Edit
                                                        </button>
                                                        <button
                                                            class="menu-item menu-item--cancel"
                                                            mat-menu-item
                                                            (click)="removeClientRate(i)">
                                                            <mat-icon>clear</mat-icon>
                                                            Delete
                                                        </button>
                                                    </mat-menu>
                                                </div>
                                            </ng-template>
                                        </ng-container>
                                    </div>
                                </ng-container>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                                <button [ngClass]="salesClientDataForm!.clientRates!.controls!.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button
                                     type="button"
                                    [matMenuTriggerFor]="clientSpecialRateMenu" #clientRateMenuTrigger="matMenuTrigger" [disabled]="isClientRateEditing">
                                    <mat-icon *ngIf="salesClientDataForm.clientRates?.controls?.length">add</mat-icon>
                                    Add special rates
                                </button>
                                <mat-menu #clientSpecialRateMenu>
                                    <mat-form-field appearance="outline" class="filter-select u-w--100" (click)="$event.stopPropagation();">
                                        <mat-label>Choose special rate</mat-label>
                                        <mat-select [formControl]="clientSpecialRateFilter" [disableOptionCentering]="true">
                                            <mat-option *ngFor="let item of clientSpecialRateList" [value]="item.id" (click)="selectClientSpecialRate($event, item, clientRateMenuTrigger)">
                                                {{ item.internalName }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </mat-menu>
                            </div>
                            <div class="inline-edit-form u-w--100">
                                <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="salesClientDataForm.clientFees?.controls?.length">
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Fee name
                                    </span>
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Frequency
                                    </span>
                                    <span fxFlex="30%" class="workflow-sales-inline--form__header u-w--100">
                                        Client fee
                                    </span>
                                    <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">

                                    </span>
                                </div>
                                <ng-container formArrayName="clientFees" class="u-w--100">
                                    <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                        *ngFor="let fee of salesClientDataForm.clientFees.controls; index as i"
                                        [formArrayName]="i">
                                        <ng-container>
                                            <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeName ?? '-'" matTooltipClass="white-tooltip">
                                                {{fee.value.feeName ?? '-'}}
                                            </span>
                                            <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeFrequency?.name ?? '-'" matTooltipClass="white-tooltip">
                                                {{fee.value.feeFrequency?.name ?? '-'}}
                                            </span>

                                            <ng-container *ngIf="fee.value.editable; else clientFeeCurrencyDisplay">
                                                <div fxFlex="30%" fxLayout="row" fxLayoutAlign="start start">
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                        <input matInput type="number" placeholder="Rate" formControlName="clientRateValue">
                                                    </mat-form-field>
                                                    <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                        <mat-select formControlName="clientRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of currencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                            </ng-container>
                                            <ng-template #clientFeeCurrencyDisplay>
                                                <span fxFlex="30%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.clientRateValue + ' ' + fee.value.clientRateCurrency?.name" matTooltipClass="white-tooltip">
                                                    {{fee.value.clientRateValue || fee.value.clientRateCurrency?.name ? fee.value.clientRateValue + ' ' + fee.value.clientRateCurrency?.name : '-'}}
                                                </span>
                                            </ng-template>

                                            <ng-container *ngIf="fee.value.editable; else clientFeeActionDisplay">
                                                <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis" fxLayoutAlign="end center">
                                                    <button mat-flat-button type="button" (click)="editOrSaveClientFee(fee.value.editable, i)" class="inline-edit-form--btn__save">
                                                        Save
                                                    </button>
                                                    <button mat-flat-button type="button" (click)="cancelEditClientFee(i)" class="inline-edit-form--btn__cancel">
                                                        Cancel
                                                    </button>
                                                </div>
                                            </ng-container>
                                            <ng-template #clientFeeActionDisplay>
                                                <div fxFlex="10%" fxLayoutAlign="end center" class="u-w--100">
                                                    <button mat-icon-button type="button" (click)="$event.stopPropagation();" [matMenuTriggerFor]="clientFeeMenu" class="three-dots-actions-btn">
                                                        <mat-icon>more_horiz</mat-icon>
                                                    </button>
                                                    <mat-menu #clientFeeMenu>
                                                        <button
                                                            class="menu-item menu-item--edit"
                                                            mat-menu-item
                                                            [disabled]="isClientFeeEditing"
                                                            (click)="editOrSaveClientFee(fee.value.editable, i)">
                                                            <mat-icon>create</mat-icon>
                                                            Edit
                                                        </button>
                                                        <button
                                                            class="menu-item menu-item--cancel"
                                                            mat-menu-item
                                                            (click)="removeClientFee(i)">
                                                            <mat-icon>clear</mat-icon>
                                                            Delete
                                                        </button>
                                                    </mat-menu>
                                                </div>
                                            </ng-template>
                                        </ng-container>
                                    </div>
                                </ng-container>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--20">
                                <button
                                    [ngClass]="salesClientDataForm!.clientFees!.controls!.length > 0 ? 'button-add' : 'button-outlined'"
                                    class="rates-and-fees--btn"
                                    mat-flat-button
                                    type="button"
                                    [disabled]="isClientFeeEditing"
                                    [matMenuTriggerFor]="clientSpecialFeeMenu"
                                    (menuOpened)="clientSpecialFeeFilter.setValue('')"
                                    #clientFeeMenuTrigger="matMenuTrigger">
                                    <mat-icon *ngIf="salesClientDataForm.clientFees?.controls?.length">add</mat-icon>
                                    Add special fees
                                </button>
                                <mat-menu #clientSpecialFeeMenu>
                                    <mat-form-field appearance="outline" class="filter-select u-w--100" (click)="$event.stopPropagation();">
                                        <mat-label>Choose special fee</mat-label>
                                        <mat-select [formControl]="clientSpecialFeeFilter" [disableOptionCentering]="true">
                                            <mat-option *ngFor="let item of clientSpecialFeeList" [value]="item.id" (click)="selectClientSpecialFee($event, item, clientFeeMenuTrigger)">
                                                {{ item.internalName }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </mat-menu>
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Evaluation</h2>
                            <h3 class="workflow-gray--header u-mb--10">Client Evaluations</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="evaluationsDisabled">
                                    <mat-button-toggle [value]="false">
                                        Enable
                                    </mat-button-toggle>
                                    <mat-button-toggle [value]="true">
                                        Disable
                                    </mat-button-toggle>
                                </mat-button-toggle-group>
                            </div>

                            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                <mat-form-field *ngIf="!salesClientDataForm?.value?.evaluationsDisabled" appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                    <mat-label>Evaluation Reference Person</mat-label>
                                    <input #evaluationReferencePersonInput type="text" matInput [matAutocomplete]="evaluationReferencePersonAutocomplete" formControlName="evaluationsReferencePersonIdValue" (click)="$event.stopPropagation()" placeholder="Final Evaluation Reference Person">
                                    <mat-autocomplete #evaluationReferencePersonAutocomplete="matAutocomplete" [displayWith]="displayFullNameFn">
                                        <ng-container>
                                            <mat-option *ngFor="let contact of filteredEvaluationReferencePersons" [value]="contact" [ngClass]="{ 'no-data': contact.id === 'no-data' }">
                                                    <b>{{ contact.firstName + ' ' + contact.lastName }}</b>
                                            </mat-option>
                                        </ng-container>
                                    </mat-autocomplete>
                                </mat-form-field>

                                <mat-form-field *ngIf="salesClientDataForm?.value?.evaluationsDisabled" appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                                    <mat-label>Disable Evaluations Reason</mat-label>
                                    <textarea matInput autocomplete="new-password" name="evaluationsDisabledReason" formControlName="evaluationsDisabledReason" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                    </textarea>
                                </mat-form-field>
                            </div>
                        </div>
                        <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                            <h2 class="workflow-section--header">Contract</h2>
                            <h3 class="workflow-gray--header u-mb--10">Special Contract Terms</h3>
                            <div fxLayout="row" fxLayoutAlign="start start" fxLayoutGap="10px" class="u-w--100 u-mb--10">
                                <mat-form-field appearance="outline" class="u-w--100  textarea-input" fxFlex="0 0 calc(66% + 16px)">
                                    <mat-label>Special Contract Terms</mat-label>
                                    <textarea matInput autocomplete="new-password" name="specialContractTerms" formControlName="specialContractTerms" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                    </textarea>
                                </mat-form-field>
                                <mat-checkbox color="accent" formControlName="noSpecialContractTerms" name="noSpecialContractTerms" class="black-checkbox u-mt--10" (change)="disableOrEnableInput(salesClientDataForm?.noSpecialContractTerms?.value, salesClientDataForm?.specialContractTerms)" >
                                    None
                                </mat-checkbox>
                            </div>

                            <h3 class="workflow-gray--header u-mb--10">Client Contract Signers</h3>
                            <div formArrayName="contractSigners" class="u-w--100 u-mb--10">
                                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngFor="let signer of contractSigners.controls; let i = index" [formGroupName]="i">
                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                        <mat-label>Name</mat-label>
                                        <input type="text" matInput [matAutocomplete]="contactSignerAutocomplete" formControlName="clientContact" (click)="$event.stopPropagation()" placeholder="Name">
                                        <mat-autocomplete #contactSignerAutocomplete="matAutocomplete" [displayWith]="displayFullNameFn">
                                            <ng-container>
                                                <mat-option *ngFor="let contact of filteredContractSigners" [value]="contact" [ngClass]="{ 'no-data': contact.id === 'no-data' }">
                                                        <b>{{ contact.firstName + ' ' + contact.lastName }}</b>
                                                </mat-option>
                                            </ng-container>
                                        </mat-autocomplete>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                        <mat-label>Client Role</mat-label>
                                        <mat-select formControlName="clientRole" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                            <mat-option *ngFor="let item of signerRoles" [value]="item">
                                                {{ item.name }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>

                                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="20%">
                                        <mat-label>Sequence</mat-label>
                                        <mat-select formControlName="clientSequence" [disableOptionCentering]="true">
                                            <mat-option *ngFor="let item of [1,2,3,4,5,6,7]" [value]="item">
                                                {{ item }}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                    <button class="form-icon--delete-row u-mt--5" type="button" mat-icon-button (click)="removeSigner(i)"><mat-icon svgIcon="remove-icon"></mat-icon></button>
                                </div>
                                <button class="button-add" mat-flat-button type="button" (click)="addSignerToForm()">
                                    <mat-icon>add</mat-icon>
                                    Add Signer
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </ng-container>
            <form [formGroup]="consultantsForm" id="consultantData" class="workflow-form--consultants u-w--100">
                <ng-container formArrayName="consultantData" class="u-mb--20">
                    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100">
                        <div *ngFor="let consultant of consultantsForm.consultantData.controls; let consultantIndex = index" [formGroupName]="consultantIndex" class="u-w--100">
                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="30px" class="u-w--100" [id]="'salesConsultantDataAnchor' + consultantIndex">
                                <h1 class="workflow-section--header-main text-nowrap">Consultant data</h1>
                                <ng-container  *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod && !readOnlyMode">
                                    <span fxFlex="auto" fxLayout="row" fxLayoutAlign="start center" class="u-w--100">
                                        <ng-container  *ngIf="consultant.value?.consultantName?.consultant?.id || consultant.value?.consultantNameOnly">
                                            <img *ngIf="consultant.value?.consultantName?.consultant?.id" class="image-thumbnail-responsive border-rounded-50 u-ml--16 u-mr--16" [src]="consultantProfileUrl(consultant.value?.consultantName?.consultant?.externalId)" />
                                            <span class="workflow-form--consultants__name u-mr--16">
                                                {{consultant.value?.consultantName?.consultant?.name}}
                                            </span>
                                        </ng-container>
                                        <button class="form-icon--delete-row" type="button" *ngIf="consultantsForm.consultantData?.controls?.length && (activeSideSection.typeId === workflowSideSections.StartClientPeriod && (isCompleted === editEnabledForcefuly))"
                                            mat-icon-button (click)="$event.stopPropagation();confirmRemoveConsultant(consultantIndex)">
                                            <mat-icon svgIcon="remove-icon"></mat-icon>
                                        </button>
                                    </span>

                                    <div fxFlex="20%" fxLayoutAlign="end center">
                                        <span class="workflow-form--consultants__period u-mr--8" *ngIf="consultant.value?.consultantProjectStartDate">
                                            {{consultant.value?.consultantProjectStartDate | momentFormat: 'DD.MM.YYYY'}} - {{consultant.value?.consultantProjectEndDate | momentFormat: 'DD.MM.YYYY'}}
                                        </span>
                                    </div>
                                </ng-container>
                            </div>

                            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod || activeSideSection.typeId === workflowSideSections.StartConsultantPeriod">
                                    <h3 class="workflow-gray--header u-mb--10">Employment type</h3>
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="employmentType">
                                            <mat-button-toggle *ngFor="let item of employmentTypes" [value]="item">
                                                {{ item.name }}
                                            </mat-button-toggle>
                                        </mat-button-toggle-group>
                                    </div>
                                    <!-- Only visible when employment type is selected and it is not 'Fee only' - id: 10 nd not 'Recruitment' - id:11 -->
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngIf="consultant.value?.employmentType?.id">
                                        <mat-form-field appearance="outline" class="u-w--100 filter-select" fxFlex="33%" *ngIf="consultant.value?.employmentType?.id !== 10 && consultant.value?.employmentType?.id !== 11; else nameOnlyConsultant">
                                            <mat-label>Consultant Name</mat-label>
                                            <input #consultantNameFilterInput type="text" matInput [matAutocomplete]="consultantAutocomplete" formControlName="consultantName" (click)="$event.stopPropagation()" placeholder="Consultant name">
                                            <mat-autocomplete #consultantAutocomplete="matAutocomplete" [displayWith]="displayConsultantNameFn">
                                                <ng-container>
                                                    <mat-option *ngFor="let item of filteredConsultants" [value]="item" [ngClass]="{ 'no-data': item.id === 'no-data' }" (click)="updateConsultantStepAnchors()">
                                                        <div class="multilineDropdown-option--row">
                                                            <img *ngIf="item.id !== 'no-data'" class="image-thumbnail-responsive border-rounded-50 u-ml--16 u-mr--16" [src]="consultantProfileUrl(item.consultant.externalId)" />
                                                            <div class="multilineDropdown-option--column">
                                                                <b>{{ item.consultant.name }}</b>
                                                                <span *ngIf="item.id !== 'no-data'"> | {{item.consultant.companyName}} | {{item.consultant.city}} | #{{item.consultant.id}} / {{item.consultant.legacyId}}</span>
                                                            </div>
                                                        </div>
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                        </mat-form-field>
                                    </div>
                                    <ng-template #nameOnlyConsultant>
                                        <mat-form-field appearance="outline" class="u-w--100 filter-select" fxFlex="33%">
                                            <mat-label>Consultant Name only</mat-label>
                                            <input type="text" matInput formControlName="consultantNameOnly" placeholder="Consultant name only">
                                        </mat-form-field>
                                    </ng-template>

                                </ng-container>
                                <ng-container *ngIf="activeSideSection.typeId === workflowSideSections.ExtendClientPeriod || activeSideSection.typeId === workflowSideSections.ChangeClientPeriod">
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <div fxLayout="column" fxFlex="25%">
                                            <h3 class="workflow-step-readonly--gray-header">Employment type</h3>
                                            <span class="workflow-step-readonly--blue-text-bold">
                                                {{consultant?.value?.employmentType?.name ? consultant?.value?.employmentType?.name : '-'}}
                                            </span>
                                        </div>
                                        <div fxLayout="column">
                                            <h3 class="workflow-step-readonly--gray-header">Consultant</h3>
                                            <div fxLayout="row" fxLayoutAlign="start center" class="u-mb--20">
                                                <img class="border-rounded-50 image-thumbnail-responsive u-mr--16" [src]="consultantProfileUrl(consultant.value.consultantName?.consultant?.externalId)">
                                                <div fxLayout="column">
                                                    <p class="workflow-extension--consultant-data--consultant-name">
                                                        {{consultant?.value?.consultantName?.consultant?.name}}
                                                    </p>
                                                    <span class="workflow-extension--consultant-data--consultant-text">
                                                        {{consultant?.value?.consultantName?.consultant?.companyName}} | {{consultant?.value?.consultantName?.consultant?.city}}, {{getTenantCodeFromId(consultant?.value?.consultantName?.consultant?.countryId)}} | #{{consultant?.value?.consultantName?.consultant?.id}} / {{getTenantCodeFromId(consultant?.value?.consultantName?.consultant?.countryId)}}-{{consultant?.value?.consultantName?.consultant?.legacyId}}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                            <!-- Only visible when employment type is selected and it is not 'Fee only' - id: 10 nd not 'Recruitment' - id:11 -->
                            <ng-container *ngIf="consultant.value?.employmentType?.id  && (consultant.value?.employmentType?.id !== 10 && consultant.value?.employmentType?.id !== 11)">
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-section--header">Contract Duration</h2>
                                    <h3 class="workflow-gray--header u-mb--10">Project duration</h3>
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="consultantProjectDurationSameAsClient">
                                            <mat-button-toggle *ngFor="let item of [{name: 'Same as client', value: true}, {name: 'Different from client', value: false}]" [value]="item.value">
                                                {{ item.name }}
                                            </mat-button-toggle>
                                        </mat-button-toggle-group>
                                    </div>

                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="!consultant.value?.consultantProjectDurationSameAsClient">
                                        <mat-form-field appearance="outline" class=" u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Start date</mat-label>
                                            <input autocomplete="off" matInput
                                                    [matDatepicker]="consultantProjectStartDatePicker"
                                                    name="consultantProjectStartDate" formControlName="consultantProjectStartDate"
                                                    (focus)="consultantProjectStartDatePicker.open()"
                                                    (click)="consultantProjectStartDatePicker.open()" readonly>
                                            <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                            <mat-datepicker #consultantProjectStartDatePicker></mat-datepicker>
                                        </mat-form-field>

                                        <mat-form-field appearance="outline" class=" u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>End date</mat-label>
                                            <input autocomplete="off" matInput
                                                    [matDatepicker]="consultantProjectEndDatePicker"
                                                    name="consultantProjectEndDate" formControlName="consultantProjectEndDate"
                                                    (focus)="consultantProjectEndDatePicker.open()"
                                                    (click)="consultantProjectEndDatePicker.open()" readonly>
                                            <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                            <mat-datepicker #consultantProjectEndDatePicker></mat-datepicker>
                                        </mat-form-field>
                                        <mat-checkbox color="accent" formControlName="consultantProjectNoEndDate" name="consultantProjectNoEndDate" class="black-checkbox u-mr--16"
                                                    (change)="disableOrEnableInput(consultantsForm.consultantData.at(consultantIndex).get('consultantProjectNoEndDate')?.value, consultantsForm.consultantData.at(consultantIndex).get('consultantProjectEndDate'))">
                                            No end date
                                        </mat-checkbox>
                                    </div>
                                </div>
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-section--header">Consultant Payment</h2>
                                    <h3 class="workflow-gray--header u-mb--10">Payment entity (consultant)</h3>
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%">
                                            <mat-label>ProData Entity</mat-label>
                                            <mat-select formControlName="consultantProdataEntity" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of tenants" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>

                                    <h3 class="workflow-gray--header u-mb--10">Price</h3>
                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                        <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="consultantPaymentType">
                                            <mat-button-toggle *ngFor="let item of clientRateTypes" [value]="item">
                                                {{ item.name }}
                                            </mat-button-toggle>
                                        </mat-button-toggle-group>
                                    </div>

                                    <ng-container class="u-w--100" [ngSwitch]="consultant.value.consultantPaymentType?.id">
                                        <ng-container *ngSwitchCase="1"> <!-- 'Time based' -->
                                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                                <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Rate</mat-label>
                                                    <input autocomplete="off" matInput formControlName="consultantRate" type="text">
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Unit type</mat-label>
                                                    <mat-select formControlName="consultantRateUnitType" [disableOptionCentering]="true" (selectionChange)="updateProdataUnitType($event, consultantIndex)">
                                                        <mat-option *ngFor="let item of rateUnitTypes" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Currency</mat-label>
                                                    <mat-select formControlName="consultantRateCurrency" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                    <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === consultant.value?.consultantPaymentType?.id) &&
                                                            (salesClientDataForm.clientCurrency?.value?.id === consultant.value?.consultantRateCurrency?.id) &&
                                                            (salesClientDataForm.rateUnitTypeId?.value?.id === consultant.value?.consultantRateUnitType?.id) &&
                                                            (salesClientDataForm.clientPrice?.value && consultant.value?.consultantRate); else calculateMarginNotPossible">
                                                            <ng-container *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id; else consultantMargin">
                                                                <ng-container *ngIf="consultant?.value?.consultantPDCRate; else calculateMarginNotPossible">
                                                                    Calculated margin
                                                                    {{ (consultant?.value?.consultantPDCRate * 1 -  consultant.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                                </ng-container>
                                                            </ng-container>
                                                            <ng-template #consultantMargin>
                                                                Calculated margin
                                                                {{ (salesClientDataForm.clientPrice?.value * 1 -  consultant.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                            </ng-template>
                                                    </span>
                                                    <ng-template #calculateMarginNotPossible>
                                                        Calculate margin is not possible
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>PDC-to-PDC rate</mat-label>
                                                    <input autocomplete="off" matInput formControlName="consultantPDCRate" type="text">
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Unit type</mat-label>
                                                    <mat-select formControlName="consultantPDCRateUnitType" [disableOptionCentering]="true" [disabled]="true">
                                                        <mat-option *ngFor="let item of rateUnitTypes" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Currency</mat-label>
                                                    <mat-select formControlName="consultantPDCRateCurrency" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                    <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === consultant.value?.consultantPaymentType?.id) &&
                                                            (salesClientDataForm.clientCurrency?.value?.id === consultant.value?.consultantPDCRateCurrency?.id) &&
                                                            (salesClientDataForm.rateUnitTypeId?.value?.id === consultant.value?.consultantPDCRateUnitType?.id) &&
                                                            (salesClientDataForm.clientPrice?.value && consultant.value?.consultantPDCRate); else calculatePDCMarginNotPossible">
                                                                Calculated margin
                                                                {{ (salesClientDataForm.clientPrice?.value * 1 -  consultant?.value?.consultantPDCRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                    </span>
                                                    <ng-template #calculatePDCMarginNotPossible>
                                                        Calculate margin is not possible
                                                    </ng-template>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngSwitchCase="2"> <!-- 'Fixed' -->
                                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                                <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Rate</mat-label>
                                                    <input autocomplete="off" matInput formControlName="consultantRate" type="text">
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Currency</mat-label>
                                                    <mat-select formControlName="consultantRateCurrency" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                    <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === consultant.value?.consultantPaymentType?.id) &&
                                                            (salesClientDataForm.clientCurrency?.value?.id === consultant.value?.consultantRateCurrency?.id) &&
                                                            (salesClientDataForm.clientPrice?.value && consultant.value?.consultantRate); else calculateFixedMarginNotPossible">
                                                            <ng-container *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id; else consultantFixedMargin">
                                                                <ng-container *ngIf="consultant?.value?.consultantPDCRate; else calculateFixedMarginNotPossible">
                                                                    Calculated margin
                                                                    {{ (consultant?.value?.consultantPDCRate * 1 -  consultant.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                                </ng-container>
                                                            </ng-container>
                                                            <ng-template #consultantFixedMargin>
                                                                Calculated margin
                                                                {{ (salesClientDataForm.clientPrice?.value * 1 -  consultant.value?.consultantRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                            </ng-template>
                                                    </span>
                                                    <ng-template #calculateFixedMarginNotPossible>
                                                        Calculate margin is not possible
                                                    </ng-template>
                                                </div>
                                            </div>

                                            <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="consultant.value?.consultantProdataEntity?.id && (consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                                <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>PDC-to-PDC rate</mat-label>
                                                    <input autocomplete="off" matInput formControlName="consultantPDCRate" type="text">
                                                </mat-form-field>
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Currency</mat-label>
                                                    <mat-select formControlName="consultantPDCRateCurrency" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <div fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                    <span *ngIf="(salesClientDataForm.clientRateAndInvoicing?.value?.id === consultant.value?.consultantPaymentType?.id) &&
                                                            (salesClientDataForm.clientCurrency?.value?.id === consultant.value?.consultantPDCRateCurrency?.id) &&
                                                            (salesClientDataForm.clientPrice?.value && consultant.value?.consultantPDCRate); else calculateFixedPDCMarginNotPossible">
                                                                Calculated margin
                                                                {{ (salesClientDataForm.clientPrice?.value * 1 -  consultant?.value?.consultantPDCRate * 1)/ salesClientDataForm.clientPrice?.value * 1 | percent: '1.2'}}
                                                    </span>
                                                    <ng-template #calculateFixedPDCMarginNotPossible>
                                                        Calculate margin is not possible
                                                    </ng-template>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngSwitchDefault>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngIf="consultant.value?.consultantPaymentType?.id === 2 ||
                                                ((salesClientDataForm.value?.pdcInvoicingEntityId?.id && consultant.value?.consultantProdataEntity?.id) &&
                                                (consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)) ||
                                                (salesClientDataForm.clientRateAndInvoicing?.value?.id !== consultant.value?.consultantPaymentType?.id)">
                                        <h3 class="workflow-gray--header u-mb--10">Invoicing information</h3>
                                    </ng-container>
                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                        <ng-container [ngSwitch]="consultant.value?.consultantPaymentType?.id">
                                            <ng-container *ngSwitchCase="1"> <!-- Time based -->
                                                <ng-container *ngIf="salesClientDataForm.clientRateAndInvoicing?.value?.id === 2">
                                                    <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%" [ngClass]="{'u-mr--16': consultant.value.consultantInvoicingFrequency?.name === 'Manual date'}">
                                                        <mat-label>Invoicing frequency</mat-label>
                                                        <mat-select formControlName="consultantInvoicingFrequency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                            <mat-option *ngFor="let item of invoiceFrequencies" [value]="item">
                                                                {{ item.name }}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </ng-container>
                                                <mat-form-field *ngIf="consultant.value.consultantInvoicingFrequency?.name === 'Manual date'" appearance="outline" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Date</mat-label>
                                                    <input autocomplete="off" matInput
                                                            [matDatepicker]="consultantInvoicingDatePicker"
                                                            name="consultantInvoicingManualDate" formControlName="consultantInvoicingManualDate"
                                                            (focus)="consultantInvoicingDatePicker.open()"
                                                            (click)="consultantInvoicingDatePicker.open()" readonly>
                                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                                    <mat-datepicker #consultantInvoicingDatePicker></mat-datepicker>
                                                </mat-form-field>
                                            </ng-container>
                                            <ng-container *ngSwitchCase="2"> <!-- Fixed -->
                                                <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="33%" [ngClass]="{'u-mr--16': consultant.value.consultantInvoicingTime?.name === 'Manual date'}">
                                                    <mat-label>Invoicing time</mat-label>
                                                    <mat-select formControlName="consultantInvoicingTime" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                        <mat-option *ngFor="let item of invoicingTimes" [value]="item">
                                                            {{ item.name }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                                <!-- id: 2 - Manual date -->
                                                <mat-form-field *ngIf="consultant.value?.consultantInvoicingTime?.id === 2" appearance="outline" fxFlex="0 0 calc(16.5% - 8px)">
                                                    <mat-label>Date</mat-label>
                                                    <input autocomplete="off" matInput
                                                            [matDatepicker]="consultantInvoicingDatePicker"
                                                            name="consultantInvoicingManualDate" formControlName="consultantInvoicingManualDate"
                                                            (focus)="consultantInvoicingDatePicker.open()"
                                                            (click)="consultantInvoicingDatePicker.open()" readonly>
                                                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                                                    <mat-datepicker #consultantInvoicingDatePicker></mat-datepicker>
                                                </mat-form-field>
                                            </ng-container>
                                        </ng-container>
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10" *ngIf="(salesClientDataForm.value?.pdcInvoicingEntityId?.id && consultant.value?.consultantProdataEntity?.id) && (consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>PDC invoicing currency</mat-label>
                                            <mat-select formControlName="prodataToProdataInvoiceCurrency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of currencies" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>

                                </div>
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-section--header">Consultant Project</h2>
                                    <h3 class="workflow-gray--header u-mb--10">Workplace</h3>
                                    <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                            <mat-checkbox color="accent" formControlName="consultantIsOnsiteWorkplace" name="consultantIsOnsiteWorkplace" class="black-checkbox u-mr--16 u-mt--10" fxFlex="0 0 calc(16.5% - 8px)">
                                                Onsite
                                            </mat-checkbox>
                                            <ng-container *ngIf="consultantsForm.consultantData.at(consultantIndex).get('consultantIsOnsiteWorkplace')?.value">
                                                <div fxLayout="column" fxFlex="0 0 calc(33% + 16px)" class="u-mr--16">
                                                    <mat-form-field appearance="outline" class="u-w--100 mat-elevation-z0">
                                                        <mat-label>Client</mat-label>
                                                        <input type="text" matInput [matAutocomplete]="consultantClientAddressAuto" formControlName="consultantWorkplaceClientAddress" (click)="$event.stopPropagation()" placeholder="Search client">
                                                        <mat-autocomplete #consultantClientAddressAuto="matAutocomplete" [displayWith]="displayClientNameFn">
                                                            <mat-option *ngFor="let client of filteredConsultantClientAddresses" [value]="client" [ngClass]="{ 'no-data': client.id === 'no-data' }">
                                                                <div class="multilineDropdown-option--column">
                                                                    <b>{{ client.clientName }}</b>
                                                                    <span *ngIf="client.id !== 'no-data'"> #{{client.clientId}} | {{client.address}} | {{client.address2}} | {{client.postCode}}</span>
                                                                </div>
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                    <span class="workflow-step-readonly--blue-text-bold" *ngIf="consultant.value.consultantWorkplaceClientAddress?.clientId">
                                                        {{consultant.value.consultantWorkplaceClientAddress?.countryName}} | {{consultant.value.consultantWorkplaceClientAddress?.address}} | {{consultant.value.consultantWorkplaceClientAddress?.address2}} | {{consultant.value.consultantWorkplaceClientAddress?.postCode}}
                                                    </span>
                                                </div>

                                                <mat-form-field appearance="outline" class="u-w--100 u-mr--16" fxFlex="0 0 calc(16% - 8px)" *ngIf="consultant.value?.consultantIsEmagineOfficeWorkplace || consultant.value?.consultantIsRemoteWorkplace">
                                                    <mat-label>Add value %</mat-label>
                                                    <input autocomplete="off" matInput formControlName="consultantWorkplacePercentageOnSite" type="text">
                                                </mat-form-field>
                                            </ng-container>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--20">
                                            <mat-checkbox color="accent" formControlName="consultantIsEmagineOfficeWorkplace" name="consultantIsEmagineOfficeWorkplace" class="black-checkbox u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                PDC Office
                                            </mat-checkbox>

                                            <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="0 0 calc(33% + 16px)" *ngIf="consultantsForm.consultantData.at(consultantIndex).get('consultantIsEmagineOfficeWorkplace')?.value">
                                                <mat-label>PDC Office address</mat-label>
                                                <mat-select formControlName="consultantWorkplaceEmagineOffice" [disableOptionCentering]="true">
                                                    <mat-option *ngFor="let item of emagineOffices" [value]="item">
                                                        {{ item.name }}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--20">
                                            <mat-checkbox color="accent" formControlName="consultantIsRemoteWorkplace" name="consultantIsRemoteWorkplace" class="black-checkbox u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                Remote
                                            </mat-checkbox>
                                            <mat-form-field appearance="outline" class="u-w--100" fxFlex="0 0 calc(33% + 16px)" *ngIf="consultantsForm.consultantData.at(consultantIndex).get('consultantIsRemoteWorkplace')?.value">
                                                <mat-label>Remote country</mat-label>
                                                <input type="text" matInput [matAutocomplete]="consultantCountryAuto" formControlName="consultantWorkplaceRemote" (click)="$event.stopPropagation()" placeholder="Search country">
                                                <mat-autocomplete #consultantCountryAuto="matAutocomplete" [displayWith]="displayNameFn">
                                                    <mat-option *ngFor="let option of filteredConsultantCountries" [value]="option">
                                                        {{option.name}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                    </div>

                                    <h3 class="workflow-gray--header u-mb--10">Expected Workload</h3>
                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                        <mat-form-field appearance="outline" class="u-w--100 mat-elevation-z0  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Hours</mat-label>
                                            <input autocomplete="off" matInput formControlName="expectedWorkloadHours" type="text">
                                        </mat-form-field>
                                        <mat-form-field appearance="outline" class="u-w--100  filter-select" fxFlex="0 0 calc(16.5% - 8px)">
                                            <mat-label>Period</mat-label>
                                            <mat-select formControlName="expectedWorkloadUnitId" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                <mat-option *ngFor="let item of expectedWorkloadUnits" [value]="item">
                                                    {{ item.name }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>

                                    <!-- 'Individual cap' Id = 3 -->
                                    <ng-container *ngIf="salesClientDataForm.capOnTimeReporting?.value?.id === 3">
                                        <h3 class="workflow-gray--header u-mb--10">Cap on Time Reporting</h3>
                                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                                            <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="consultantCapOnTimeReporting">
                                                <mat-button-toggle *ngFor="let item of consultantTimeReportingCapList" [value]="item">
                                                    {{ item.name }}
                                                </mat-button-toggle>
                                            </mat-button-toggle-group>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--20">
                                            <ng-container [ngSwitch]="consultant.value?.consultantCapOnTimeReporting.id">
                                                <ng-container *ngSwitchCase="1">  <!-- 'Cap on units' -->
                                                    <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                        <mat-label>Max value</mat-label>
                                                        <input autocomplete="off" matInput formControlName="consultantTimeReportingCapMaxValue" type="text">
                                                    </mat-form-field>
                                                    <div fxFlex="0 0 calc(16.5% - 8px)" fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                        <ng-container [ngSwitch]="consultant.value.consultantRateUnitType?.id">
                                                            <ng-container *ngSwitchCase="1"> <!-- Per hour -->
                                                                hours
                                                            </ng-container>
                                                            <ng-container *ngSwitchCase="2"> <!-- Per day -->
                                                                days
                                                            </ng-container>
                                                            <ng-container *ngSwitchCase="3"> <!-- Per month -->
                                                                months
                                                            </ng-container>
                                                        </ng-container>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="2"> <!-- 'Cap on value' -->
                                                    <mat-form-field appearance="outline" class="u-w--100  u-mr--16" fxFlex="0 0 calc(16.5% - 8px)">
                                                        <mat-label>Max value</mat-label>
                                                        <input autocomplete="off" matInput formControlName="consultantTimeReportingCapMaxValue" type="text">
                                                    </mat-form-field>
                                                    <div fxFlex="0 0 calc(16.5% - 8px)" fxLayoutAlign="start center" class="workflow-form--consultants__payment-price-text">
                                                        {{consultant.value.consultantRateCurrency?.name}}
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngSwitchCase="4"> <!-- 'No cap' -->
                                                </ng-container>
                                            </ng-container>
                                        </div>
                                    </ng-container>

                                </div>
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-section--header">Rates and fees</h2>

                                    <div class="inline-edit-form u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="consultant.value.specialRates?.length">
                                            <span fxFlex="1 0 20%" class="workflow-sales-inline--form__header u-w--100">
                                                Rate name
                                            </span>
                                            <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                                Reporting unit
                                            </span>
                                            <span fxFlex="25%" class="workflow-sales-inline--form__header u-w--100" *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                ProData rate
                                            </span>
                                            <span fxFlex="25%" class="workflow-sales-inline--form__header u-w--100">
                                                Consultant rate
                                            </span>
                                            <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">
                                            </span>
                                        </div>
                                        <ng-container formArrayName="specialRates" class="u-w--100">
                                            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                                *ngFor="let rate of getConsultantRateControls(consultantIndex); let specialRateIndex = index;"
                                                [formArrayName]="specialRateIndex">
                                                <ng-container>
                                                    <span fxFlex="1 0 20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.rateName" matTooltipClass="white-tooltip">
                                                        {{rate.value.rateName ?? '-'}}
                                                    </span>
                                                    <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.reportingUnit?.name" matTooltipClass="white-tooltip">
                                                        {{rate.value.reportingUnit?.name ?? '-'}}
                                                    </span>
                                                    <ng-container *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                        <ng-container *ngIf="rate.value.editable; else consutlantProDataRateCurrencyDisplay">
                                                            <div fxFlex="25%" fxLayout="row" fxLayoutAlign="start start">
                                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                                    <input matInput type="number" placeholder="Rate" formControlName="prodataToProdataRate">
                                                                </mat-form-field>
                                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                                    <mat-select formControlName="prodataToProdataRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                                            {{ item.name }}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                        </ng-container>
                                                        <ng-template #consutlantProDataRateCurrencyDisplay>
                                                            <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.prodataToProdataRate + ' ' + rate.value.prodataToProdataRateCurrency?.name" matTooltipClass="white-tooltip">
                                                                {{rate.value.prodataToProdataRate || rate.value.prodataToProdataRateCurrency?.name ? rate.value.prodataToProdataRate + ' ' + rate.value.prodataToProdataRateCurrency?.name : '-'}}
                                                            </span>
                                                        </ng-template>
                                                    </ng-container>

                                                    <ng-container *ngIf="rate.value.editable; else consutlantRateCurrencyDisplay">
                                                        <div fxFlex="25%" fxLayout="row" fxLayoutAlign="start start">
                                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                                <input matInput type="number" placeholder="Rate" formControlName="consultantRate">
                                                            </mat-form-field>
                                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                                <mat-select formControlName="consultantRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                                    <mat-option *ngFor="let item of currencies" [value]="item">
                                                                        {{ item.name }}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #consutlantRateCurrencyDisplay>
                                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="rate.value.consultantRate + ' ' + rate.value.consultantRateCurrency?.name" matTooltipClass="white-tooltip">
                                                            {{rate.value.consultantRate || rate.value.consultantRateCurrency?.name ? rate.value.consultantRate + ' ' + rate.value.consultantRateCurrency?.name : '-'}}
                                                        </span>
                                                    </ng-template>
                                                    <ng-container *ngIf="rate.value.editable; else consultantRateActionDisplay">
                                                        <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                                            <button mat-flat-button type="button" (click)="editOrSaveConsultantRate(consultantIndex, specialRateIndex, rate.value.editable)" class="inline-edit-form--btn__save">
                                                                Save
                                                            </button>
                                                            <button mat-flat-button type="button" (click)="cancelEditConsultantRate(consultantIndex, specialRateIndex)" class="inline-edit-form--btn__cancel">
                                                                Cancel
                                                            </button>
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #consultantRateActionDisplay>
                                                        <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100">
                                                            <button mat-icon-button type="button" (click)="$event.stopPropagation();" [matMenuTriggerFor]="consutlantRateMenu" class="three-dots-actions-btn">
                                                                <mat-icon>more_horiz</mat-icon>
                                                            </button>
                                                            <mat-menu #consutlantRateMenu>
                                                                <button
                                                                    class="menu-item menu-item--edit"
                                                                    mat-menu-item
                                                                    [disabled]="isConsultantRateEditing"
                                                                    (click)="editOrSaveConsultantRate(consultantIndex, specialRateIndex, rate.value.editable)">
                                                                    <mat-icon>create</mat-icon>
                                                                    Edit
                                                                </button>
                                                                <button
                                                                    class="menu-item menu-item--cancel"
                                                                    mat-menu-item
                                                                    (click)="removeConsutlantRate(consultantIndex, specialRateIndex)">
                                                                    <mat-icon>clear</mat-icon>
                                                                    Delete
                                                                </button>
                                                            </mat-menu>
                                                        </div>
                                                    </ng-template>
                                                </ng-container>
                                            </div>
                                        </ng-container>
                                    </div>

                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--10">
                                        <button [ngClass]="consultant.value.specialRates?.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button
                                            [matMenuTriggerFor]="consultantSpecialRateMenu"
                                            [disabled]="isConsultantRateEditing"
                                            type="button"
                                            (menuOpened)="consultantsForm.consultantData.at(consultantIndex).get('consultantSpecialRateFilter')!.setValue('')"
                                            #consultantRateMenuTrigger="matMenuTrigger"
                                            [matMenuTriggerData]="{consultantIndex: consultantIndex}">
                                            <mat-icon *ngIf="consultant.value.specialRates?.length">add</mat-icon>
                                            Add special rate
                                        </button>
                                        <mat-menu #consultantSpecialRateMenu>
                                            <ng-template matMenuContent let-consultantIndex="consultantIndex">
                                                <mat-form-field appearance="outline" class="filter-select u-w--100" (click)="$event.stopPropagation();">
                                                    <mat-label>Choose special rate</mat-label>
                                                    <mat-select formControlName="consultantSpecialRateFilter" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of clientSpecialRateList" [value]="item.id" (click)="selectConsultantSpecialRate($event, consultantIndex, item, consultantRateMenuTrigger)">
                                                            {{ item.internalName }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </ng-template>
                                        </mat-menu>
                                    </div>

                                    <div class="inline-edit-form u-w--100">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="10px" class="workflow-sales-inline--form__header-container u-w--100" *ngIf="consultant.value.specialFees?.length">
                                            <span fxFlex="1 1 20%" class="workflow-sales-inline--form__header u-w--100">
                                                Fee name
                                            </span>
                                            <span fxFlex="20%" class="workflow-sales-inline--form__header u-w--100">
                                                Frequency
                                            </span>
                                            <span fxFlex="25%" class="workflow-sales-inline--form__header u-w--100" *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                ProData fee
                                            </span>
                                            <span fxFlex="25%" class="workflow-sales-inline--form__header u-w--100">
                                                Consultant fee
                                            </span>
                                            <span fxFlex="10%" class="workflow-sales-inline--form__header u-w--100">

                                            </span>
                                        </div>
                                        <ng-container formArrayName="specialFees" class="u-w--100">
                                            <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="10px" class="workflow-sales-inline--form__row u-w--100"
                                                *ngFor="let fee of getConsultantFeeControls(consultantIndex); let specialFeeIndex = index;"
                                                [formArrayName]="specialFeeIndex">
                                                <ng-container>
                                                    <span fxFlex="1 1 20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.feeName ?? '-'" matTooltipClass="white-tooltip">
                                                        {{fee.value.feeName ?? '-'}}
                                                    </span>
                                                    <span fxFlex="20%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.frequency?.name ?? '-'" matTooltipClass="white-tooltip">
                                                        {{fee.value.frequency?.name ?? '-'}}
                                                    </span>
                                                    <ng-container *ngIf="consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id">
                                                        <ng-container *ngIf="fee.value.editable; else proDataFeeCurrencyDisplay">
                                                            <div fxFlex="25%" fxLayout="row" fxLayoutAlign="start start">
                                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                                    <input matInput type="number" placeholder="Rate" formControlName="prodataToProdataRate">
                                                                </mat-form-field>
                                                                <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                                    <mat-select formControlName="prodataToProdataRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                                        <mat-option *ngFor="let item of currencies" [value]="item">
                                                                            {{ item.name }}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                        </ng-container>
                                                        <ng-template #proDataFeeCurrencyDisplay>
                                                            <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.prodataToProdataRate + ' ' + fee.value.prodataToProdataRateCurrency?.name" matTooltipClass="white-tooltip">
                                                                {{fee.value.prodataToProdataRate || fee.value.prodataToProdataRateCurrency?.name ? fee.value.prodataToProdataRate + ' ' + fee.value.prodataToProdataRateCurrency?.name : '-'}}
                                                            </span>
                                                        </ng-template>
                                                    </ng-container>

                                                    <ng-container *ngIf="fee.value.editable; else consultantFeeCurrencyDisplay">
                                                        <div fxFlex="25%" fxLayout="row" fxLayoutAlign="start start">
                                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="40%">
                                                                <input matInput type="number" placeholder="Rate" formControlName="consultantRate">
                                                            </mat-form-field>
                                                            <mat-form-field appearance="fill" class="u-w--100 formFieldNoMarginPadding filter-select" fxFlex="60%">
                                                                <mat-select formControlName="consultantRateCurrency" placeholder="Currency" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                                                                    <mat-option *ngFor="let item of currencies" [value]="item">
                                                                        {{ item.name }}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #consultantFeeCurrencyDisplay>
                                                        <span fxFlex="25%" class="u-w--100 text-truncate-ellipsis" [matTooltip]="fee.value.consultantRate + ' ' + fee.value.consultantRateCurrency?.name" matTooltipClass="white-tooltip">
                                                            {{fee.value.consultantRate || fee.value.consultantRateCurrency?.name ? fee.value.consultantRate + ' ' + fee.value.consultantRateCurrency?.name : '-'}}
                                                        </span>
                                                    </ng-template>

                                                    <ng-container *ngIf="fee.value.editable; else clientFeeActionDisplay">
                                                        <div fxFlex="10%" class="u-w--100 text-truncate-ellipsis flex-items-center">
                                                            <button mat-flat-button type="button" (click)="editOrSaveConsultantFee(consultantIndex, specialFeeIndex, fee.value.editable)" class="inline-edit-form--btn__save">
                                                                Save
                                                            </button>
                                                            <button mat-flat-button type="button" (click)="cancelEditConsultantFee(consultantIndex, specialFeeIndex)" class="inline-edit-form--btn__cancel">
                                                                Cancel
                                                            </button>
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #clientFeeActionDisplay>
                                                        <div fxFlex="10%" fxLayoutAlign="center center" class="u-w--100">
                                                            <button mat-icon-button type="button" (click)="$event.stopPropagation();" [matMenuTriggerFor]="consultantFeeMenu" class="three-dots-actions-btn">
                                                                <mat-icon>more_horiz</mat-icon>
                                                            </button>
                                                            <mat-menu #consultantFeeMenu>
                                                                <button
                                                                    class="menu-item menu-item--edit"
                                                                    mat-menu-item
                                                                    (click)="editOrSaveConsultantFee(consultantIndex, specialFeeIndex, fee.value.editable)">
                                                                    <mat-icon>create</mat-icon>
                                                                    Edit
                                                                </button>
                                                                <button
                                                                    class="menu-item menu-item--cancel"
                                                                    mat-menu-item
                                                                    (click)="removeConsutlantFee(consultantIndex, specialFeeIndex)">
                                                                    <mat-icon>clear</mat-icon>
                                                                    Delete
                                                                </button>
                                                            </mat-menu>
                                                        </div>
                                                    </ng-template>
                                                </ng-container>
                                            </div>
                                        </ng-container>
                                    </div>

                                    <div fxLayout="row" fxLayoutAlign="start start" class="u-mb--20">
                                        <button [ngClass]="consultant.value.specialFees?.length > 0 ? 'button-add' : 'button-outlined'" class="rates-and-fees--btn" mat-flat-button
                                            [matMenuTriggerFor]="consultantSpecialFeeMenu"
                                            [disabled]="isConsultantFeeEditing"
                                            type="button"
                                            #consultantFeeMenuTrigger="matMenuTrigger"
                                            [matMenuTriggerData]="{consultantIndex: consultantIndex}">
                                            <mat-icon *ngIf="consultant.value.specialFees?.length">add</mat-icon>
                                            Add special fees
                                        </button>
                                        <mat-menu #consultantSpecialFeeMenu>
                                            <ng-template matMenuContent let-consultantIndex="consultantIndex">
                                                <mat-form-field appearance="outline" class="filter-select u-w--100" (click)="$event.stopPropagation();">
                                                    <mat-label>Choose special fee</mat-label>
                                                    <mat-select formControlName="consultantSpecialFeeFilter" [disableOptionCentering]="true">
                                                        <mat-option *ngFor="let item of clientSpecialFeeList" [value]="item.id" (click)="selectConsultantSpecialFee($event, consultantIndex, item, consultantFeeMenuTrigger)">
                                                            {{ item.internalName }}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </ng-template>
                                        </mat-menu>
                                    </div>
                                </div>

                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <h2 class="workflow-section--header">Consultant Contract</h2>
                                    <h3 class="workflow-gray--header u-mb--10">Special Contract Terms</h3>
                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100">
                                        <mat-form-field appearance="outline" class="u-w--100  textarea-input u-mr--16" fxFlex="0 0 calc(66% + 16px)">
                                            <mat-label>Consultant Special Contract Terms</mat-label>
                                            <textarea matInput autocomplete="new-password" name="consultantSpecialContractTerms" formControlName="consultantSpecialContractTerms" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                                            </textarea>
                                        </mat-form-field>
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                        <mat-checkbox color="accent" formControlName="consultantSpecialContractTermsNone" name="consultantSpecialContractTermsNone" class="black-checkbox u-mr--16" (change)="disableOrEnableInput(consultant?.value?.consultantSpecialContractTermsNone, consultant?.get('consultantSpecialContractTerms'))">
                                            None
                                        </mat-checkbox>
                                    </div>
                                </div>
                                <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                                <ng-container *ngIf="(consultant.value?.consultantProdataEntity?.id && salesClientDataForm.value?.pdcInvoicingEntityId?.id) && (consultant.value?.consultantProdataEntity?.id !== salesClientDataForm.value?.pdcInvoicingEntityId?.id)">
                                    <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                        <h2 class="workflow-section--header">Account manager</h2>
                                        <div fxLayout="row" fxLayoutAlign="start center" class="u-w--100 u-mb--10">
                                            <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%">
                                                <mat-label>Delivery Account manager</mat-label>
                                                <input #deliveryManagerFilterInput type="text" matInput [matAutocomplete]="deliveryManagerAutocomplete" formControlName="deliveryAccountManager" (click)="$event.stopPropagation()" placeholder="Select account manager(s)">
                                            </mat-form-field>
                                            <mat-autocomplete #deliveryManagerAutocomplete="matAutocomplete" [displayWith]="displayNameFn">
                                                <ng-container>
                                                    <mat-option *ngFor="let manager of filteredAccountManagers"
                                                        [value]="manager"
                                                        [ngClass]="{ 'no-data': manager.id === 'no-data' }">
                                                        <span>{{ manager.name }}</span>
                                                    </mat-option>
                                                </ng-container>
                                            </mat-autocomplete>
                                            <mat-checkbox color="accent" formControlName="deliveryManagerSameAsAccountManager" name="deliveryManagerSameAsAccountManager" class="black-checkbox u-mr--10"
                                                (change)="disableOrEnableInput(consultant?.value?.deliveryManagerSameAsAccountManager, consultant?.get('deliveryAccountManager'))">
                                                Same as account manager
                                            </mat-checkbox>
                                        </div>
                                    </div>
                                    <mat-divider class="u-w--100 u-mt--20 u-mb--20"></mat-divider>
                                </ng-container>
                            </ng-container>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100" *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod">
                            <button class="button-add mat-elevation-z0 u-mt--10 u-mb--10"  type="button" mat-flat-button (click)="addConsultantForm()">
                                <mat-icon>add</mat-icon>
                                Add consultant
                            </button>
                        </div>
                    </div>
                </ng-container>
            </form>
        </ng-container>
    </ng-template>
</div>
<ng-template #terminationTemplate>
    <ng-container *ngIf="readOnlyMode; else editMode">
        <div fxLayout="column" fxLayoutAlign="start start" class="workflow-sales--process-data u-w--100">
            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                <h1 class="workflow-step-readonly--header-main">
                    <span class="process-name">Sales.</span>
                    <span class="anchor-name" *ngIf="activeSideSection.typeId === workflowSideSections.TerminateConsultant">End of Consultant Contract</span>
                    <span class="anchor-name" *ngIf="activeSideSection.typeId === workflowSideSections.TerminateWorkflow">End of Client Contract</span>
                </h1>

                <div fxLayout="column" class="u-w--100 u-mb--20 u-mt--20">
                    <h3 class="workflow-step-readonly--gray-header">Non standart termination time</h3>
                    <span class="workflow-step-readonly--blue-text-bold">
                        {{salesTerminateConsultantForm?.terminationTime?.value ? nonStandartTerminationTimes[salesTerminateConsultantForm?.terminationTime?.value] : '-'}}
                    </span>
                </div>

                <div fxLayout="column" class="u-w--100 u-mb--20" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2">
                    <h3 class="workflow-step-readonly--gray-header">End date</h3>
                    <span class="workflow-step-readonly--blue-text-bold">
                        {{salesTerminateConsultantForm?.endDate?.value ? (salesTerminateConsultantForm?.endDate?.value | momentFormat: 'DD/MM/YYYY') : '-'}}
                    </span>
                </div>

                <div fxLayout="column" class="u-w--100 u-mb--20" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2 || salesTerminateConsultantForm?.terminationTime?.value === 3">
                    <h3 class="workflow-step-readonly--gray-header">Termination reason</h3>
                    <span class="workflow-step-readonly--blue-text-bold">
                        {{salesTerminateConsultantForm?.terminationReason?.value ? terminationReasons[salesTerminateConsultantForm?.terminationReason?.value] : '-'}}
                    </span>
                </div>

                <div fxLayout="column" class="u-w--100 u-mb--20" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2 || salesTerminateConsultantForm?.terminationTime?.value === 3">
                    <h3 class="workflow-step-readonly--gray-header">Cause</h3>
                    <p class="workflow-step-readonly--blue-text">
                        {{salesTerminateConsultantForm?.causeOfNonStandardTerminationTime?.value ? salesTerminateConsultantForm?.causeOfNonStandardTerminationTime?.value : '-'}}
                    </p>
                </div>

                <div fxLayout="column" class="u-w--100 u-mb--20">
                    <h3 class="workflow-step-readonly--gray-header">Additional comments</h3>
                    <p class="workflow-step-readonly--blue-text">
                        {{salesTerminateConsultantForm?.additionalComments?.value ? salesTerminateConsultantForm?.additionalComments?.value : '-'}}
                    </p>
                </div>

                <div fxLayout="column" class="u-w--100 u-mb--20" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 1 || salesTerminateConsultantForm?.terminationTime?.value === 2">
                    <h3 class="workflow-step-readonly--gray-header">Final Evaluation Reference Person</h3>
                    <p class="workflow-step-readonly--blue-text-bold">
                        {{salesTerminateConsultantForm?.noEvaluation?.value ? 'No evaluation' : (salesTerminateConsultantForm?.finalEvaluationReferencePerson?.value ? salesTerminateConsultantForm?.finalEvaluationReferencePerson?.value?.firstName + ' ' + salesTerminateConsultantForm?.finalEvaluationReferencePerson?.value?.lastName : '-')}}
                    </p>

                    <div fxLayout="column" class="u-w--100 u-mt--20" *ngIf="salesTerminateConsultantForm?.noEvaluation?.value === true">
                        <h3 class="workflow-step-readonly--gray-header">Cause</h3>
                        <p class="workflow-step-readonly--blue-text">
                            {{salesTerminateConsultantForm?.causeOfNoEvaluation?.value ? salesTerminateConsultantForm?.causeOfNoEvaluation?.value : '-'}}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
    <ng-template #editMode>
        <form [formGroup]="salesTerminateConsultantForm" class="workflow-form--consultants workflow--termination u-mb--20 u-w--100">
            <h3 class="workflow-gray--header u-mt--20" *ngIf="activeSideSection.typeId === workflowSideSections.TerminateConsultant">End of Consultant Contract</h3>
            <h3 class="workflow-gray--header u-mt--20" *ngIf="activeSideSection.typeId === workflowSideSections.TerminateWorkflow">End of Client Contract</h3>

            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10">
                <mat-button-toggle-group class="workflow-toggle-buttons u-mt--10" formControlName="terminationTime">
                    <mat-button-toggle
                        *ngFor="let item of nonStandartTerminationTimes | keyvalue"
                        [value]="+item.key">
                            {{ item.value }}
                    </mat-button-toggle>
                </mat-button-toggle-group>
            </div>

            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2">
                <mat-form-field appearance="outline">
                    <mat-label>End date</mat-label>
                    <input autocomplete="off" matInput
                            [matDatepicker]="endClientContractEndDatePicker"
                            name="clientContractEndDate" formControlName="endDate"
                            (focus)="endClientContractEndDatePicker.open()"
                            (click)="endClientContractEndDatePicker.open()" readonly>
                    <mat-icon class="calendar-icon" matSuffix svgIcon="calendar"></mat-icon>
                    <mat-datepicker #endClientContractEndDatePicker></mat-datepicker>
                </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2 || salesTerminateConsultantForm?.terminationTime?.value === 3">
                <mat-button-toggle-group class="workflow-toggle-buttons" formControlName="terminationReason">
                    <mat-button-toggle
                        [value]="+item.key"
                        *ngFor="let item of terminationReasons | keyvalue">
                        {{ item.value }}
                    </mat-button-toggle>
                </mat-button-toggle-group>
            </div>

            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100"  *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 2 || salesTerminateConsultantForm?.terminationTime?.value === 3">
                <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                    <mat-label>Cause</mat-label>
                    <textarea matInput autocomplete="new-password" name="causeOfTerminationBeforeEndOfContract" formControlName="causeOfNonStandardTerminationTime" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                    </textarea>
                </mat-form-field>
            </div>

            <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20 u-mt--10">
                <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                    <mat-label>Additional comments</mat-label>
                    <textarea matInput autocomplete="new-password" name="additionalComments" formControlName="additionalComments" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                    </textarea>
                </mat-form-field>
            </div>

            <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100" *ngIf="salesTerminateConsultantForm?.terminationTime?.value === 1 || salesTerminateConsultantForm?.terminationTime?.value === 2">
                <h3 class="workflow-gray--header">Final Evaluation</h3>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10 u-mt--10">
                    <mat-form-field appearance="outline" class="u-w--100  filter-select u-mr--16" fxFlex="33%" [ngClass]="{'disabled-input': salesTerminateConsultantForm?.noEvaluation?.value}">
                        <mat-label>Final Evaluation Reference Person</mat-label>
                        <input #finalEvaluationReferencePersonInput type="text" matInput [matAutocomplete]="finalEvaluationReferencePersonAutocomplete" formControlName="finalEvaluationReferencePerson" (click)="$event.stopPropagation()" placeholder="Final Evaluation Reference Person">
                        <mat-autocomplete #finalEvaluationReferencePersonAutocomplete="matAutocomplete" [displayWith]="displayFullNameFn">
                            <ng-container>
                                <mat-option *ngFor="let contact of filteredFinalEvaluationReferencePersons" [value]="contact" [ngClass]="{ 'no-data': contact.id === 'no-data' }">
                                        <b>{{ contact.firstName + ' ' + contact.lastName }}</b>
                                </mat-option>
                            </ng-container>
                        </mat-autocomplete>
                    </mat-form-field>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--20">
                    <mat-checkbox color="accent" formControlName="noEvaluation" name="noEvaluation" class="black-checkbox" (change)="disableOrEnableInput(salesTerminateConsultantForm?.noEvaluation?.value, salesTerminateConsultantForm?.finalEvaluationReferencePerson)">
                        No evaluation
                    </mat-checkbox>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mb--10" *ngIf="salesTerminateConsultantForm?.noEvaluation?.value === true">
                    <mat-form-field appearance="outline" class="u-w--100 textarea-input " fxFlex="0 0 calc(66% + 16px)">
                        <mat-label>Cause</mat-label>
                        <textarea matInput autocomplete="new-password" name="causeOfNoEvaluation" formControlName="causeOfNoEvaluation" [matTextareaAutosize]="true" [matAutosizeMinRows]="2">
                        </textarea>
                    </mat-form-field>
                </div>
            </div>
        </form>
    </ng-template>
</ng-template>
