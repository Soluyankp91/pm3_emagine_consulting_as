<form [formGroup]="contractsMainForm" id="mainDataAnchor" class="workflow-form workflow-form--main u-w--100">
    <div fxLayout="column" fxLayoutAlign="start start" class="workflow-contracts--process-data u-w--100">
        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
            <div fxLayout="row" fxLayoutAlign="space-between center" class="u-w--100">
                <h1 class="workflow-section--header-main">Main data</h1>
                <ng-container *ngIf="readOnlyMode">
                    <toggle-edit-mode [canToggleEditMode]="canToggleEditMode" (editModeToggled)="toggleEditMode()"></toggle-edit-mode>
                </ng-container>
            </div>
            <div fxLayout="row" fxLayoutAlign="start center" class="u-mt--16 u-mb--16" id="contractMainProject">
                <span class="workflow-section--number">1</span>
                <h2 class="workflow-section--header">Project</h2>
            </div>
            <div class="workflow-section--content">
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                    <mat-form-field appearance="outline" class="formFieldNoMarginPadding filter-select form-width-372">
                        <mat-label>Project Type (Legacy)</mat-label>
                        <mat-select required [disabled]="true" formControlName="projectType" [disableOptionCentering]="true" [compareWith]="compareWithFn">
                            <ng-container *ngFor="let item of projectTypes; trackBy: trackById">
                                <mat-option [value]="item">
                                    {{ item.name }}
                                </mat-option>
                            </ng-container>
                        </mat-select>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.projectType"></app-validator>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxLayout="column" fxLayoutAlign="start start">
                    <h3 class="workflow-darkblue--text u-mt--15 u-mb--10">Sales type</h3>
                    <mat-button-toggle-group [disabled]="true"
                        [ngClass]="{'mat-form-field-invalid': !contractsMainForm.salesType?.valid}" class="workflow-toggle-buttons"
                        formControlName="salesType" required>
                        <ng-container *ngFor="let item of saleTypes; trackBy: trackById">
                            <ng-container *ngIf="item.id === contractsMainForm.salesType?.value?.id">
                                <mat-button-toggle [value]="item">{{item.name}}</mat-button-toggle>
                            </ng-container>
                        </ng-container>
                    </mat-button-toggle-group>
                    <mat-error>
                        <app-validator [withoutFormField]="true" *ngIf="contractsMainForm.salesType?.touched"
                            [control]="contractsMainForm.salesType"></app-validator>
                    </mat-error>
                </div>
                <div fxLayout="column" fxLayoutAlign="start start">
                    <h3 class="workflow-darkblue--text u-mt--20 u-mb--10">Delivery type</h3>
                    <mat-button-toggle-group [disabled]="true"
                        [ngClass]="{'mat-form-field-invalid': !contractsMainForm.deliveryType?.valid}" class="workflow-toggle-buttons"
                        formControlName="deliveryType" required>
                        <ng-container *ngFor="let item of deliveryTypes; trackBy: trackById">
                            <ng-container *ngIf="(item?.id === deliveryTypesEnum.ManagedService && contractsMainForm.salesType?.value?.id === salesTypesEnum.ManagedService) || (item?.id !== deliveryTypesEnum.ManagedService && contractsMainForm.salesType?.value?.id !== salesTypesEnum.ManagedService)">
                                <ng-container *ngIf="item.id === contractsMainForm.deliveryType?.value?.id">
                                    <mat-button-toggle [value]="item">
                                        {{ item.name }}
                                    </mat-button-toggle>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </mat-button-toggle-group>
                    <mat-error>
                        <ng-container *ngIf="contractsMainForm.deliveryType?.touched">
                            <app-validator [withoutFormField]="true" [control]="contractsMainForm.deliveryType"></app-validator>
                        </ng-container>
                    </mat-error>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100 u-mt--15">
                    <mat-form-field appearance="outline" class="formFieldNoMarginPadding filter-select form-width-180">
                        <mat-label>Margin</mat-label>
                        <mat-select [disabled]="true" formControlName="margin" [disableOptionCentering]="true" [compareWith]="compareWithFn" required>
                            <mat-option class="mat-select-clear-option">
                                Clear
                            </mat-option>
                            <ng-container *ngFor="let item of margins; trackBy: trackById">
                                <mat-option [value]="item">
                                    {{ item.name }}
                                </mat-option>
                            </ng-container>
                        </mat-select>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.margin"></app-validator>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                    <mat-form-field appearance="outline" class="textarea-input formFieldNoMarginPadding form-width-564"
                        [ngClass]="{'disabled-input': readOnlyMode}">
                        <mat-label>Project Name</mat-label>
                        <textarea [disabled]="readOnlyMode" matInput autocomplete="new-password" name="projectName"
                            formControlName="projectName" [cdkTextareaAutosize]="true" [cdkAutosizeMinRows]="2">
                                    </textarea>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.projectName"></app-validator>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                    <mat-form-field appearance="outline" class="textarea-input formFieldNoMarginPadding form-width-564"
                        [ngClass]="{'disabled-input': readOnlyMode}">
                        <mat-label>Project Description</mat-label>
                        <textarea [disabled]="readOnlyMode" matInput autocomplete="new-password"
                            name="projectDescription" formControlName="projectDescription" [cdkTextareaAutosize]="true"
                            [cdkAutosizeMinRows]="2">
                                    </textarea>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.projectDescription"></app-validator>
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
        </div>
        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100" id="contractAdditionalData">
            <div fxLayout="row" fxLayoutAlign="start center" class="u-mt--16 u-mb--16">
                <span class="workflow-section--number">2</span>
                <h2 class="workflow-section--header">Additional data</h2>
            </div>
            <div class="workflow-section--content">
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                    <mat-form-field appearance="outline" class="formFieldNoMarginPadding filter-select form-width-150">
                        <mat-label>Discounts</mat-label>
                        <mat-select [disabled]="true" formControlName="discounts" [disableOptionCentering]="true"
                            [compareWith]="compareWithFn">
                            <mat-option class="mat-select-clear-option">
                                Clear
                            </mat-option>
                            <ng-container *ngFor="let item of discounts; trackBy: trackById">
                                <mat-option [value]="item">
                                    {{ item?.name }}
                                </mat-option>
                            </ng-container>
                        </mat-select>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.discounts"></app-validator>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div fxLayout="row" fxLayoutAlign="start start" class="u-w--100">
                    <mat-form-field appearance="outline"
                        class="textarea-input formFieldNoMarginPadding disabled-input u-mr--12 form-width-564">
                        <mat-label>Remarks</mat-label>
                        <textarea [disabled]="true" matInput autocomplete="new-password" name="remarks"
                            formControlName="remarks" [cdkTextareaAutosize]="true" [cdkAutosizeMinRows]="2">
                                    </textarea>
                        <mat-error>
                            <app-validator [control]="contractsMainForm.remarks"></app-validator>
                        </mat-error>
                    </mat-form-field>
                    <ng-container *ngIf="contractsMainForm.noRemarks?.value">
                        <mat-checkbox [disabled]="true" color="accent" formControlName="noRemarks" name="noRemarks"
                            class="black-checkbox u-mt--8"
                            (change)="disableOrEnableInput(contractsMainForm.noRemarks?.value, contractsMainForm.remarks)">
                            None
                        </mat-checkbox>
                    </ng-container>
                </div>
            </div>
        </div>
        <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100" id="contractDocuments">
            <div fxLayout="row" fxLayoutAlign="start center" class="u-mt--16 u-mb--16">
                <span class="workflow-section--number">3</span>
                <h2 class="workflow-section--header">Documents</h2>
            </div>
            <div class="workflow-section--content">
                <app-documents #mainDocuments [readOnlyMode]="readOnlyMode"></app-documents>
            </div>
        </div>
    </div>
    <button #submitFormBtn class="display-none" type="submit">Hidden button to set form submitted</button>
</form>
