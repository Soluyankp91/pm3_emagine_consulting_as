<div class="workflow-contracts">
    <ng-container *ngIf="canToggleEditMode">
        <button class="absolute-edit-toggle" mat-icon-button appPreventDoubleClick
            (throttledClick)="toggleEditMode(true)"><mat-icon svgIcon="edit-icon"></mat-icon></button>
    </ng-container>
    <ng-container [ngSwitch]="true">
        <ng-container
            *ngSwitchCase="activeSideSection.typeId === workflowSideSections.TerminateWorkflow || activeSideSection.typeId === workflowSideSections.TerminateConsultant">
            <div class="workflow--termination">

                <app-contracts-sync-data #syncDataComponent [readOnlyMode]="readOnlyMode"
                (onSyncToLegacySystem)="processSyncToLegacySystem()" [contractClientForm]="clientDataComponent?.contractClientForm"></app-contracts-sync-data>

                <form fxLayout="column" fxLayoutAlign="start start" [formGroup]="contractsTerminationConsultantForm"
                    class="workflow-form u-w--100" id="consultantData">
                    <ng-container formArrayName="consultantTerminationContractData">
                        <ng-container *ngFor="let consultant of contractsTerminationConsultantForm.consultantTerminationContractData.controls; index as i; last as last" [formGroupName]="i">
                            <div class="workflow-contracts--block-consultants u-mt--20" [ngClass]="{'last-block': last}" [id]="'consultantDataAnchor' + i">
                                <app-consultant-information [consultantData]="consultant?.value?.consultantData"></app-consultant-information>
                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <ng-container *ngIf="!readOnlyMode || consultant.get('removedConsultantFromAnyManualChecklists')?.value">
                                        <mat-checkbox required [disabled]="readOnlyMode" color="accent" name="removedConsultantFromAnyManualChecklists"
                                            formControlName="removedConsultantFromAnyManualChecklists" class="black-checkbox u-mr--10"
                                            [ngClass]="{'mat-form-field-invalid': consultant.get('removedConsultantFromAnyManualChecklists')!.touched && !consultant.get('removedConsultantFromAnyManualChecklists')!.valid}">
                                            Removed Consultant from any manual checklists
                                        </mat-checkbox>
                                        <mat-error>
                                            <ng-container *ngIf="consultant.get('removedConsultantFromAnyManualChecklists')!.touched && !consultant.get('removedConsultantFromAnyManualChecklists')!.valid">
                                                <app-validator [withoutFormField]="true" [control]="consultant.get('removedConsultantFromAnyManualChecklists')"></app-validator>
                                            </ng-container>
                                        </mat-error>
                                    </ng-container>
                                    <mat-error>
                                        <ng-container
                                            *ngIf="consultant.get('removedConsultantFromAnyManualChecklists')!.touched && !consultant.get('removedConsultantFromAnyManualChecklists')!.valid">
                                            <app-validator [withoutFormField]="true"
                                                [control]="consultant.get('removedConsultantFromAnyManualChecklists')"></app-validator>
                                        </ng-container>
                                    </mat-error>
                                </div>

                                <div fxLayout="column" fxLayoutAlign="start start" class="u-w--100">
                                    <ng-container *ngIf="!readOnlyMode || consultant.get('deletedAnySensitiveDocumentsForGDPR')?.value">
                                        <mat-checkbox required [disabled]="readOnlyMode" color="accent" name="deletedAnySensitiveDocumentsForGDPR"
                                            formControlName="deletedAnySensitiveDocumentsForGDPR" class="black-checkbox u-mr--10"
                                            [ngClass]="{'mat-form-field-invalid': consultant.get('deletedAnySensitiveDocumentsForGDPR')!.touched && !consultant.get('deletedAnySensitiveDocumentsForGDPR')!.valid}">
                                            Deleted any sensitive documents (GDPR)
                                        </mat-checkbox>
                                        <mat-error>
                                            <ng-container *ngIf="consultant.get('deletedAnySensitiveDocumentsForGDPR')!.touched && !consultant.get('deletedAnySensitiveDocumentsForGDPR')!.valid">
                                                <app-validator [withoutFormField]="true" [control]="consultant.get('deletedAnySensitiveDocumentsForGDPR')"></app-validator>
                                            </ng-container>
                                        </mat-error>
                                    </ng-container>
                                    <mat-error>
                                        <ng-container
                                            *ngIf="consultant.get('deletedAnySensitiveDocumentsForGDPR')!.touched && !consultant.get('deletedAnySensitiveDocumentsForGDPR')!.valid">
                                            <app-validator [withoutFormField]="true"
                                                [control]="consultant.get('deletedAnySensitiveDocumentsForGDPR')"></app-validator>
                                        </ng-container>
                                    </mat-error>
                                </div>
                            </div>
                        </ng-container>
                    </ng-container>
                </form>
            </div>
        </ng-container>
        <ng-container *ngSwitchDefault>
            <app-contracts-main-data #mainDataComponent [readOnlyMode]="readOnlyMode"></app-contracts-main-data>
            <ng-container
                *ngIf="activeSideSection.typeId === workflowSideSections.StartClientPeriod || activeSideSection.typeId === workflowSideSections.ExtendClientPeriod || activeSideSection.typeId === workflowSideSections.ChangeClientPeriod">
                <app-contracts-client-data #clientDataComponent [readOnlyMode]="readOnlyMode"
                    [clientSpecialRateList]="clientSpecialRateList"
                    [clientSpecialFeeList]="clientSpecialFeeList"></app-contracts-client-data>
            </ng-container>

            <app-contracts-consultant-data #consultantDataComponent [readOnlyMode]="readOnlyMode"
                [clientSpecialRateList]="clientSpecialRateList" [clientSpecialFeeList]="clientSpecialFeeList"
                [contractsMainForm]="mainDataComponent?.contractsMainForm"
                [contractClientForm]="clientDataComponent?.contractClientForm"></app-contracts-consultant-data>

            <app-contracts-sync-data #syncDataComponent [readOnlyMode]="readOnlyMode" [activeSideSection]="activeSideSection" [periodId]="periodId"
                [contractClientForm]="clientDataComponent?.contractClientForm" (onSyncToLegacySystem)="processSyncToLegacySystem()"></app-contracts-sync-data>

        </ng-container>
    </ng-container>
</div>

